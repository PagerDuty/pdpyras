
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>PDPYRAS: PagerDuty Python REST API Sessions &#8212; PagerDuty Python REST API Sessions 4.5.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="pdpyras-pagerduty-python-rest-api-sessions">
<h1>PDPYRAS: PagerDuty Python REST API Sessions<a class="headerlink" href="#pdpyras-pagerduty-python-rest-api-sessions" title="Permalink to this heading">¶</a></h1>
<p>A lightweight Python client for the PagerDuty REST API.</p>
<p>Also includes clients for the Events and Change Events APIs.</p>
<p><a class="reference external" href="https://circleci.com/gh/PagerDuty/pdpyras"><img alt="circleci-build" src="https://circleci.com/gh/PagerDuty/pdpyras.svg?style=svg" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/PagerDuty/pdpyras">GitHub repository</a></p></li>
<li><p><a class="reference external" href="https://pagerduty.github.io/pdpyras">Documentation</a></p></li>
<li><p><a class="reference external" href="https://github.com/PagerDuty/pdpyras/tree/master/CHANGELOG.rst">Changelog</a></p></li>
</ul>
<section id="about">
<h2>About<a class="headerlink" href="#about" title="Permalink to this heading">¶</a></h2>
<p>This library supplies a class <a class="reference internal" href="#pdpyras.APISession" title="pdpyras.APISession"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdpyras.APISession</span></code></a> extending
<a class="reference external" href="https://docs.python-requests.org/en/master/api/#request-sessions">requests.Session</a> from the <a class="reference external" href="https://docs.python-requests.org/en/master/">Requests</a> HTTP library. It serves as a practical
and simple-as-possible-but-no-simpler HTTP client for accessing the PagerDuty
REST API and events API.</p>
<p>It takes care of all of the most common prerequisites and necessities
pertaining to accessing the API so that implementers can focus on the request
and response body schemas of each particular resource (as documented in our
<a class="reference external" href="https://developer.pagerduty.com/api-reference/">REST API Reference</a>) and do what they need to get done.</p>
<section id="features">
<h3>Features<a class="headerlink" href="#features" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Uses Requests’ automatic HTTP connection pooling and persistence</p></li>
<li><p>Tested in / support for Python 3.5 through 3.9</p></li>
<li><p>Configurable cooldown/reattempt logic for handling rate limiting and
transient HTTP or network issues</p></li>
<li><p>Abstraction for <a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTU4-pagination">pagination</a>, <a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTYx-wrapped-entities">wrapped entities</a>, <a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTUx-authentication">API authentication</a> and
more</p></li>
</ul>
</section>
<section id="history">
<h3>History<a class="headerlink" href="#history" title="Permalink to this heading">¶</a></h3>
<p>This module was borne of necessity for a basic API client to eliminate code
duplication in some of PagerDuty Support’s internal Python-based API tooling.</p>
<p>We found ourselves frequently performing REST API requests using beta or
non-documented API endpoints for one reason or another, so we needed the client
that provided easy access to features of the underlying HTTP library (i.e. to
obtain the response headers, or set special request headers). We also needed
something that eliminated tedious tasks like querying objects by name,
pagination and authentication. Finally, we discovered that the way we were
using <a class="reference external" href="https://docs.python-requests.org/en/master/">Requests</a> wasn’t making use of its connection pooling feature, and
wanted a way to easily enforce this as a standard practice.</p>
<p>We evaluated at the time a few other open-source API libraries and deemed them
to be either overkill for our purposes or not giving the implementer enough
control over how API calls were made.</p>
</section>
<section id="copyright">
<h3>Copyright<a class="headerlink" href="#copyright" title="Permalink to this heading">¶</a></h3>
<p>All the code in this distribution is Copyright (c) 2018 PagerDuty.</p>
<p><code class="docutils literal notranslate"><span class="pre">pdpyras</span></code> is made available under the MIT License:</p>
<blockquote>
<div><p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the “Software”), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.</p>
</div></blockquote>
</section>
<section id="warranty">
<h3>Warranty<a class="headerlink" href="#warranty" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.</p>
</div></blockquote>
</section>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading">¶</a></h2>
<p>If <code class="docutils literal notranslate"><span class="pre">pip</span></code> is available, it can be installed via:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip install pdpyras
</pre></div>
</div>
<p>Alternately, if <a class="reference external" href="https://docs.python-requests.org/en/master/">requests</a> has already been installed locally, and <code class="docutils literal notranslate"><span class="pre">urllib3</span></code>
is available, one can simply download <a class="reference external" href="https://raw.githubusercontent.com/PagerDuty/pdpyras/master/pdpyras.py">pdpyras.py</a> into the directory where it
will be used.</p>
</section>
<section id="usage-guide">
<h2>Usage Guide<a class="headerlink" href="#usage-guide" title="Permalink to this heading">¶</a></h2>
<section id="authentication">
<h3>Authentication<a class="headerlink" href="#authentication" title="Permalink to this heading">¶</a></h3>
<p>All REST API examples included in this documentation assume that the variable
<code class="docutils literal notranslate"><span class="pre">session</span></code> is an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">APISession</span></code>. When constructing an
instance, the first argument, required, is always the API key used for <a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTUx-authentication">API
authentication</a>.</p>
<p>If the session will be used for API endpoints that require a <code class="docutils literal notranslate"><span class="pre">From</span></code> header,
such as taking actions on incidents, and if using an account-level API key
(created by an administrator via the “API Access Keys” page in the
“Integrations” menu), it is recommended to also include the <code class="docutils literal notranslate"><span class="pre">default_from</span></code>
keyword argument, or HTTP 400 responses will result when attempting to
use such endpoints.</p>
<p>Otherwise, if using a user’s API key (created under “API Access” in the “User
Settings” tab of the user’s profile), the user will be derived from the key
itself and <code class="docutils literal notranslate"><span class="pre">default_from</span></code> is not necessary.</p>
<p>When encountering status 401 (unauthorized), the client will immediately raise
<a class="reference internal" href="#pdpyras.PDClientError" title="pdpyras.PDClientError"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdpyras.PDClientError</span></code></a>, as this can be considered a non-transient error
under any circumstance.</p>
<section id="using-a-basic-rest-api-key">
<h4>Using a basic REST API key<a class="headerlink" href="#using-a-basic-rest-api-key" title="Permalink to this heading">¶</a></h4>
<p>For example, given an environment variable <code class="docutils literal notranslate"><span class="pre">PD_API_KEY</span></code> set to an
account-wide REST API key, and a dummy user in the PagerDuty account with email
address “<a class="reference external" href="mailto:api&#37;&#52;&#48;example-company&#46;com">api<span>&#64;</span>example-company<span>&#46;</span>com</a>”:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pdpyras</span> <span class="kn">import</span> <span class="n">APISession</span>

<span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PD_API_KEY&#39;</span><span class="p">]</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">APISession</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">default_from</span><span class="o">=</span><span class="s2">&quot;api@example-company.com&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="using-an-oauth2-token">
<h4>Using an OAuth2 token<a class="headerlink" href="#using-an-oauth2-token" title="Permalink to this heading">¶</a></h4>
<p>When using an OAuth2 token, pass the keyword argument <code class="docutils literal notranslate"><span class="pre">auth_type='oauth2'</span></code>
or <code class="docutils literal notranslate"><span class="pre">auth_type='bearer'</span></code> to the constructor. This tells the client to set the
<code class="docutils literal notranslate"><span class="pre">Authorization</span></code> header appropriately in order to use this type of API
credential.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span> <span class="o">=</span> <span class="n">APISession</span><span class="p">(</span><span class="n">oauth_token_here</span><span class="p">,</span> <span class="n">auth_type</span><span class="o">=</span><span class="s1">&#39;oauth2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note, obtaining an access token via the OAuth 2 flow is outside the purview of
an API client, and should be performed separately by your application.</p>
<p>For further information on OAuth 2 authentication with PagerDuty, refer to the
official documentation:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://v2.developer.pagerduty.com/docs/oauth-2-functionality">OAuth 2 Functionality</a></p></li>
<li><p><a class="reference external" href="https://v2.developer.pagerduty.com/docs/oauth-2-functionality-pkce">OAuth 2: PKCE Flow</a></p></li>
<li><p><a class="reference external" href="https://v2.developer.pagerduty.com/docs/oauth-2-functionality-client-secret">OAuth 2: Authorization Code Grant Flow</a></p></li>
</ul>
</section>
</section>
<section id="basic-usage">
<h3>Basic usage<a class="headerlink" href="#basic-usage" title="Permalink to this heading">¶</a></h3>
<p>Some examples of usage:</p>
<p><strong>Basic getting:</strong> Obtain a user profile as a dict object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using get:</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/users/PABC123&#39;</span><span class="p">)</span>
<span class="n">user</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
  <span class="n">user</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span>

<span class="c1"># Using rget:</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">rget</span><span class="p">(</span><span class="s1">&#39;/users/PABC123&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Pagination (1):</strong> Iterate over all users and print their ID, email and name:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">session</span><span class="o">.</span><span class="n">iter_all</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">],</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p><strong>Pagination (2):</strong> Compile a list of all services with “SN” in their name:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">services</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">list_all</span><span class="p">(</span><span class="s1">&#39;services&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="s1">&#39;SN&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p><strong>Cursor-based pagination:</strong> look up audit trail records for all PagerDuty objects going back 24 hours:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">audit_records</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">iter_cursor</span><span class="p">(</span><span class="s1">&#39;/audit/records&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p><strong>Querying:</strong> Find a user exactly matching email address <code class="docutils literal notranslate"><span class="pre">jane&#64;example35.com</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">user</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;jane@example35.com&#39;</span><span class="p">,</span> <span class="n">attribute</span><span class="o">=</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Updating using put / rput</strong>: assuming there is a variable <code class="docutils literal notranslate"><span class="pre">user</span></code>
defined that is a dictionary representation of a PagerDuty user,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
  <span class="n">updated_user</span> <span class="o">=</span> <span class="kc">None</span>

  <span class="c1"># (1) using put directly:</span>
  <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;self&#39;</span><span class="p">],</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;user&#39;</span><span class="p">:{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Jane Doe&#39;</span><span class="p">}</span>
  <span class="p">})</span>
  <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
    <span class="n">updated_user</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span>

  <span class="c1"># (2) using rput (no entity wrapping required):</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">updated_user</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">rput</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;self&#39;</span><span class="p">],</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Jane Doe&#39;</span>
    <span class="p">})</span>
  <span class="k">except</span> <span class="n">PDClientError</span><span class="p">:</span>
    <span class="n">updated_user</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
<p><strong>Updating/creating using persist (idempotent create/update function)</strong>:
assuming a dict object <code class="docutils literal notranslate"><span class="pre">user_data</span></code> is defined, and it is structured like a
PagerDuty user object, containing at least the name and email address fields,
this will look for a user with its <code class="docutils literal notranslate"><span class="pre">email</span></code> field equal to the <code class="docutils literal notranslate"><span class="pre">email</span></code> value
in <code class="docutils literal notranslate"><span class="pre">user_data</span></code>, and update that user according to the contents of
<code class="docutils literal notranslate"><span class="pre">user_data</span></code> (or create one with attributes according to <code class="docutils literal notranslate"><span class="pre">user_data</span></code> if it
doesn’t already exist):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
  <span class="n">updated_user</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">persist</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="n">user_data</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">except</span> <span class="n">PDClientError</span><span class="p">:</span>
  <span class="n">updated_user</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
<p><strong>Multiple update:</strong> acknowledge all triggered incidents assigned to user with
ID <code class="docutils literal notranslate"><span class="pre">PHIJ789</span></code>. Note that to acknowledge, we need to set the <code class="docutils literal notranslate"><span class="pre">From</span></code> header.
This example assumes that <code class="docutils literal notranslate"><span class="pre">admin&#64;example.com</span></code> corresponds to a user in the
PagerDuty account:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Query incidents</span>
<span class="n">incidents</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">list_all</span><span class="p">(</span>
    <span class="s1">&#39;incidents&#39;</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;user_ids[]&#39;</span><span class="p">:[</span><span class="s1">&#39;PHIJ789&#39;</span><span class="p">],</span><span class="s1">&#39;statuses[]&#39;</span><span class="p">:[</span><span class="s1">&#39;triggered&#39;</span><span class="p">]}</span>
<span class="p">)</span>

<span class="c1"># Change their state</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">incidents</span><span class="p">:</span>
    <span class="n">i</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;acknowledged&#39;</span>

<span class="c1"># PUT the updated list back up to the API</span>
<span class="n">updated_incidents</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">rput</span><span class="p">(</span><span class="s1">&#39;incidents&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">incidents</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="general-concepts">
<h3>General concepts<a class="headerlink" href="#general-concepts" title="Permalink to this heading">¶</a></h3>
<p>In all cases, when sending or receiving data through the REST API using
<a class="reference internal" href="#pdpyras.APISession" title="pdpyras.APISession"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdpyras.APISession</span></code></a>, the following will apply.</p>
<section id="urls">
<h4>URLs<a class="headerlink" href="#urls" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p><strong>There is no need to include the API base URL.</strong> Any path relative to the web
root, leading slash or no, is automatically appended to the base URL when
constructing an API request, i.e. one can specify <code class="docutils literal notranslate"><span class="pre">users/PABC123</span></code> or
<code class="docutils literal notranslate"><span class="pre">/users/PABC123</span></code> instead of <code class="docutils literal notranslate"><span class="pre">https://api.pagerduty.com/users/PABC123</span></code>.</p></li>
<li><p>One can also pass the full URL of an API endpoint and it will still work, i.e.
the <code class="docutils literal notranslate"><span class="pre">self</span></code> property of any object can be used, and there is no need to strip
out the API base URL.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">r*</span></code> methods, i.e. <code class="docutils literal notranslate"><span class="pre">rget</span></code>, can accept a dictionary object
representing an API resource in place of a URL (in which case the value at
the <code class="docutils literal notranslate"><span class="pre">self</span></code> key will be used as the URL).</p></li>
</ul>
</section>
<section id="request-and-response-bodies">
<h4>Request and response bodies<a class="headerlink" href="#request-and-response-bodies" title="Permalink to this heading">¶</a></h4>
<p>To set the request body in a post or put request, pass a <code class="docutils literal notranslate"><span class="pre">json</span></code> keyword
argument that will be JSON-encoded and sent as the body to the HTTP verb
method. To obtain the response from the API:</p>
<ul class="simple">
<li><p>If using <code class="docutils literal notranslate"><span class="pre">request</span></code>, <code class="docutils literal notranslate"><span class="pre">get</span></code>, <code class="docutils literal notranslate"><span class="pre">post</span></code> (etc) directly, a <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a>
object is returned. That object’s <code class="docutils literal notranslate"><span class="pre">json()</span></code> method will return the response
body decoded from JSON as a Python dict object.</p></li>
<li><p>If using the <code class="docutils literal notranslate"><span class="pre">j*</span></code> methods (<code class="docutils literal notranslate"><span class="pre">jget</span></code>, <code class="docutils literal notranslate"><span class="pre">jpost</span></code> etc.) or the <code class="docutils literal notranslate"><span class="pre">r*</span></code> methods
(<code class="docutils literal notranslate"><span class="pre">rget</span></code>, <code class="docutils literal notranslate"><span class="pre">rpost</span></code> etc), or any other method that makes API calls: objects
returned will be from JSON-decoding the body of the API response if successful;
otherwise <code class="xref py py-class docutils literal notranslate"><span class="pre">PDClientError</span></code> will be raised.</p></li>
</ul>
</section>
<section id="resource-schemas">
<h4>Resource schemas<a class="headerlink" href="#resource-schemas" title="Permalink to this heading">¶</a></h4>
<p>Main article: <a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTU5-resource-schemas">Resource Schemas</a></p>
<p>Concerning the structure of objects in response and request bodies: this
library does not contain abstraction of PagerDuty API schemas. Rather, it
provides abstraction for the basics of API access. The details of any interface
between API schema and application are left to the implementer’s judgment. The
intent of not insulating the implementer from schemas is to avoid the client
becoming “an API for the API”.</p>
<p>The details of any given resource’s schema can be found in the request and
response examples from the <a class="reference external" href="https://developer.pagerduty.com/api-reference/">REST API Reference</a> pages for the resource’s
respective API, as well as the page documenting the resource type itself.</p>
</section>
<section id="data-types">
<h4>Data types<a class="headerlink" href="#data-types" title="Permalink to this heading">¶</a></h4>
<p>Main article: <a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTU1-types">Types</a></p>
<p>Note these analogues in structure between the JSON schema and the object
in Python:</p>
<ul class="simple">
<li><p>If the data type documented in the schema is
<a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTU1-types#object">object</a>,
then the corresponding type of the Python object will be <code class="docutils literal notranslate"><span class="pre">dict</span></code>.</p></li>
<li><p>If the data type documented in the schema is
<a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTU1-types#array">array</a>,
then the corresponding type of the Python object will be <code class="docutils literal notranslate"><span class="pre">list</span></code>.</p></li>
<li><p>Generally speaking, the data type in the decoded object is according to the
design of the <a class="reference external" href="https://docs.python.org/3/library/json.html">json</a> Python library.</p></li>
</ul>
<p>For example, consider the example structure of an escalation policy as given in the
<a class="reference external" href="https://developer.pagerduty.com/api-reference/b3A6Mjc0ODEyNg-get-an-escalation-policy">GET /escalation_policies/{id}</a>
API reference page. To access the name of the second target in level 1,
assuming the variable <code class="docutils literal notranslate"><span class="pre">ep</span></code> represents the unwrapped escalation policy object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ep</span><span class="p">[</span><span class="s1">&#39;escalation_rules&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;targets&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span>
<span class="c1"># &quot;Daily Engineering Rotation&quot;</span>
</pre></div>
</div>
<p>To add a new level, one would need to create a new
<a class="reference external" href="https://developer.pagerduty.com/api-reference/c2NoOjI3NDgwMjI-escalation-rule">escalation rule</a>
and then append it to the <code class="docutils literal notranslate"><span class="pre">escalation</span> <span class="pre">rules</span></code> property. Using the example
given in the above API reference page:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">new_rule</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;escalation_delay_in_minutes&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
  <span class="s2">&quot;targets&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;PAM4FGS&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;user_reference&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;PI7DH85&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;schedule_reference&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
<span class="n">ep</span><span class="p">[</span><span class="s1">&#39;escalation_rules&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_rule</span><span class="p">)</span>
<span class="c1"># Save changes:</span>
<span class="n">session</span><span class="o">.</span><span class="n">rput</span><span class="p">(</span><span class="n">ep</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">ep</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="using-http-client-library-features">
<h4>Using HTTP client library features<a class="headerlink" href="#using-http-client-library-features" title="Permalink to this heading">¶</a></h4>
<p>For all request functions: keyword arguments to the HTTP verb methods and their
<code class="docutils literal notranslate"><span class="pre">r*</span></code> / <code class="docutils literal notranslate"><span class="pre">j*</span></code> equivalents get passed through to the similarly-named
functions in <a class="reference external" href="https://docs.python-requests.org/en/master/api/#request-sessions">requests.Session</a>. Furthermore, the methods <code class="docutils literal notranslate"><span class="pre">get</span></code>, <code class="docutils literal notranslate"><span class="pre">post</span></code>,
<code class="docutils literal notranslate"><span class="pre">put</span></code>, <code class="docutils literal notranslate"><span class="pre">delete</span></code> and <code class="docutils literal notranslate"><span class="pre">request</span></code> return <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> objects, whose
properties contain information about the request and response.</p>
<p>Note also that since <a class="reference internal" href="#pdpyras.PDSession" title="pdpyras.PDSession"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdpyras.PDSession</span></code></a> is subclassed directly from
<a class="reference external" href="https://docs.python-requests.org/en/master/api/#request-sessions">requests.Session</a> , it behaves as a <code class="docutils literal notranslate"><span class="pre">Session</span></code> object and so all of the
documented features of that class can also be used. For example, to configure
<code class="docutils literal notranslate"><span class="pre">10.42.187.3:4012</span></code> as a proxy for HTTPS traffic:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">proxies</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;https&#39;</span><span class="p">:</span> <span class="s1">&#39;10.42.187.3:4012&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>For documentation on additional options and features, refer to
<a class="reference external" href="https://requests.readthedocs.io/en/latest/api/">Requests’ developer interface documentation</a></p>
</section>
</section>
<section id="wrapped-entities">
<h3>Wrapped entities<a class="headerlink" href="#wrapped-entities" title="Permalink to this heading">¶</a></h3>
<p>Main article: <a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTYx-wrapped-entities">wrapped entities</a>
(formerly the term “resource envelope” was used).</p>
<p>Most of PagerDuty’s endpoints respond with their data inside of a key at the
root level of the JSON-encoded object in the response. The key is named after
the resource, whether singular or plural. All endpoints that follow this
convention are supported by methods that eliminate the need for the implementer
to wrap and unwrap resource entities.</p>
<section id="functions-that-assume-entity-wrapping">
<h4>Functions that assume entity wrapping<a class="headerlink" href="#functions-that-assume-entity-wrapping" title="Permalink to this heading">¶</a></h4>
<p>Generally, instead of returning a <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object or requiring
entity wrapping in the object to be JSON-encoded as the request body, some
functions can accept an unwrapped entity to be sent in the request body, and
will return the contents of the wrapped entity in the response from the API. If
the request’s status was not success, or a wrapped entity could not be found in
the response, <a class="reference internal" href="#pdpyras.PDClientError" title="pdpyras.PDClientError"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdpyras.PDClientError</span></code></a> will be raised otherwise (if the
request’s status was not success, or no entity wrapping could be deduced).</p>
<ul class="simple">
<li><p>The “<code class="docutils literal notranslate"><span class="pre">r*</span></code> methods” <code class="docutils literal notranslate"><span class="pre">rput</span></code>, <code class="docutils literal notranslate"><span class="pre">rpost</span></code> and <code class="docutils literal notranslate"><span class="pre">rget</span></code>. They will perform the
same HTTP actions as <code class="docutils literal notranslate"><span class="pre">put</span></code>, <code class="docutils literal notranslate"><span class="pre">post</span></code> and <code class="docutils literal notranslate"><span class="pre">get</span></code> and similarly accept the
same keyword arguments as <code class="docutils literal notranslate"><span class="pre">requests.Session.request</span></code>. the <code class="docutils literal notranslate"><span class="pre">json</span></code> keyword
argument (for <code class="docutils literal notranslate"><span class="pre">rpost</span></code>/<code class="docutils literal notranslate"><span class="pre">rput</span></code>), the value can be the</p></li>
<li><p><a class="reference internal" href="#pdpyras.APISession.find" title="pdpyras.APISession.find"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.find</span></code></a>, <a class="reference internal" href="#pdpyras.APISession.iter_all" title="pdpyras.APISession.iter_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.iter_all</span></code></a>,
<a class="reference internal" href="#pdpyras.APISession.list_all" title="pdpyras.APISession.list_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.list_all</span></code></a> and <a class="reference internal" href="#pdpyras.APISession.dict_all" title="pdpyras.APISession.dict_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.dict_all</span></code></a>
each assume that the API index endpoint being queried follows the classic
entity wrapping conventions.</p></li>
<li><p><a class="reference internal" href="#pdpyras.APISession.persist" title="pdpyras.APISession.persist"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.persist</span></code></a> uses <code class="docutils literal notranslate"><span class="pre">rput</span></code>, <code class="docutils literal notranslate"><span class="pre">rpost</span></code> and <code class="docutils literal notranslate"><span class="pre">find</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iter_cursor</span></code>, although it assumes a much looser definition of entity
wrapping: the root level key in the response body can be set using the
<code class="docutils literal notranslate"><span class="pre">attribute</span></code> keyword argument, and if unspecified it will guess that it is
the same as the last node in the URL path. This is according to the design of
all current Audit record APIs, which as of this writing are the only APIs that
support cursor-based pagination.</p></li>
</ul>
</section>
<section id="supported-endpoints">
<h4>Supported endpoints<a class="headerlink" href="#supported-endpoints" title="Permalink to this heading">¶</a></h4>
<p>The general rules are that the name of the wrapped resource key must follow
predictably from the innermost resource name for the API path in question
whether singular or plural, and that the “nodes” in the URL path (between
forward slashes) must alternate between resource type and ID.</p>
<p><strong>Supported endpoint example:</strong> for <code class="docutils literal notranslate"><span class="pre">/escalation_policies/{id}</span></code> the wrapper
name for singular post/put is <code class="docutils literal notranslate"><span class="pre">escalation_policy</span></code>, and for <code class="docutils literal notranslate"><span class="pre">GET</span>
<span class="pre">/escalation_policies</span></code> it is <code class="docutils literal notranslate"><span class="pre">escalation_policies</span></code>. For
<code class="docutils literal notranslate"><span class="pre">/users/{id}/notification_rules</span></code> the wrapper is named <code class="docutils literal notranslate"><span class="pre">notification_rule</span></code>
for singular post/put and <code class="docutils literal notranslate"><span class="pre">notification_rules</span></code> for the index, <code class="docutils literal notranslate"><span class="pre">GET</span>
<span class="pre">/users/{id}/notification_rules</span></code>.</p>
<p><strong>Unsupported endpoint example:</strong> in the
<a class="reference external" href="https://developer.pagerduty.com/api-reference/b3A6Mjc0ODI0OQ-list-a-user-s-active-sessions">user sessions</a>
API endpoints, URLs are formatted as
<code class="docutils literal notranslate"><span class="pre">/users/{id}/sessions/{type}/{session_id}</span></code> whereas the wrapped resource
property name is <code class="docutils literal notranslate"><span class="pre">user_sessions</span></code> / <code class="docutils literal notranslate"><span class="pre">user_session</span></code> rather than simply
<code class="docutils literal notranslate"><span class="pre">sessions</span></code> / <code class="docutils literal notranslate"><span class="pre">session</span></code>.</p>
</section>
<section id="list-of-non-conformal-endpoints">
<h4>List of non-conformal endpoints<a class="headerlink" href="#list-of-non-conformal-endpoints" title="Permalink to this heading">¶</a></h4>
<p>The following list of APIs and endpoints (last updated: 2022-03-15) are
unsupported by methods <code class="docutils literal notranslate"><span class="pre">rget</span></code>, <code class="docutils literal notranslate"><span class="pre">rpost</span></code>, <code class="docutils literal notranslate"><span class="pre">rput</span></code>, <code class="docutils literal notranslate"><span class="pre">persist</span></code>, <code class="docutils literal notranslate"><span class="pre">find</span></code>,
<code class="docutils literal notranslate"><span class="pre">iter_all</span></code>, <code class="docutils literal notranslate"><span class="pre">list_all</span></code> and <code class="docutils literal notranslate"><span class="pre">dict_all</span></code> because they do not follow the
classic entity wrapping  conventions on which the functions are based. They can
still be used with the basic <code class="docutils literal notranslate"><span class="pre">get</span></code>, <code class="docutils literal notranslate"><span class="pre">post</span></code>, <code class="docutils literal notranslate"><span class="pre">put</span></code> and <code class="docutils literal notranslate"><span class="pre">delete</span></code> methods.</p>
<ul class="simple">
<li><p>Analytics</p></li>
<li><p>All Audit endpoints (<a class="reference internal" href="#pdpyras.APISession.iter_cursor" title="pdpyras.APISession.iter_cursor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.iter_cursor</span></code></a> should be used instead, as they feature cursor-based pagination)</p></li>
<li><p>All Notification Subscription endpoints</p></li>
<li><p>Paused Incident Reports</p></li>
<li><dl class="simple">
<dt>The following Business Services endpoints:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/business_services/{id}/account_subscription</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/business_services/{id}/supporting_services/impacts</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/business_services/impactors</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/business_services/impacts</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[GET|PUT]</span> <span class="pre">/business_services/priority_thresholds</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>The following Incident API endpoints:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">[GET|PUT]</span> <span class="pre">/incidents/{id}/business_services/impacts`</span></code>: list or manually change any of an incident’s impacts on business services</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PUT</span> <span class="pre">/incidents/{id}/merge</span></code>: merge incidents</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/incidents/{id}/responder_requests</span></code>: create a responder request for an incident</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/incidents/{id}/snooze</span></code>: snooze an incident</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Event Orchestrations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/schedules/{id}/overrides</span></code> (create one or more schedule overrides)</p></li>
<li><p>Service Dependencies</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/{entity_type}/{id}/change_tags</span></code> (assign tags)</p></li>
<li><p>Updating team membership (adding or removing users or escalation policies)</p></li>
<li><p>User sessions</p></li>
</ul>
</section>
</section>
<section id="pagination">
<h3>Pagination<a class="headerlink" href="#pagination" title="Permalink to this heading">¶</a></h3>
<p>The method <a class="reference internal" href="#pdpyras.APISession.iter_all" title="pdpyras.APISession.iter_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.iter_all</span></code></a> returns an iterator that yields
results from a resource index, automatically incrementing the <code class="docutils literal notranslate"><span class="pre">offset</span></code>
parameter to advance through each page of data and make API requests on-demand.</p>
<p>For all endpoints that support cursor-based pagination,
<a class="reference internal" href="#pdpyras.APISession.iter_cursor" title="pdpyras.APISession.iter_cursor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.iter_cursor</span></code></a> should be used instead.</p>
<p>Note, one can perform <a class="reference external" href="https://v2.developer.pagerduty.com/docs/filtering">filtering</a> with iteration to constrain
constrain the range of results, by passing in a dictionary object as the <code class="docutils literal notranslate"><span class="pre">params</span></code>
keyword argument. Any parameters will be automatically merged with the pagination
parameters and serialized into the final URL, so there is no need to manually
construct the URL, i.e. appending <code class="docutils literal notranslate"><span class="pre">?key1=value1&amp;key2=value2</span></code>.</p>
<p><strong>Example:</strong> Find all users with “Dav” in their name/email (i.e. Dave/David) in
the PagerDuty account:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">dave</span> <span class="ow">in</span> <span class="n">session</span><span class="o">.</span><span class="n">iter_all</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;query&#39;</span><span class="p">:</span><span class="s2">&quot;Dav&quot;</span><span class="p">}):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> &lt;</span><span class="si">%s</span><span class="s2">&gt;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">dave</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">dave</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]))</span>
</pre></div>
</div>
<p>Also, note, as of version 2.2, there are the methods
<a class="reference internal" href="#pdpyras.APISession.list_all" title="pdpyras.APISession.list_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.list_all</span></code></a> and <a class="reference internal" href="#pdpyras.APISession.dict_all" title="pdpyras.APISession.dict_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.dict_all</span></code></a>
which return a list or dictionary of all results, respectively.</p>
<p><strong>Example:</strong> Get a dictionary of all users, keyed by email, and use it to find
the ID of the user whose email is <code class="docutils literal notranslate"><span class="pre">bob&#64;example.com</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">users</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">dict_all</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">users</span><span class="p">[</span><span class="s1">&#39;bob@example.com&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
</pre></div>
</div>
<section id="performance">
<h4>Performance<a class="headerlink" href="#performance" title="Permalink to this heading">¶</a></h4>
<p>Because HTTP requests are made synchronously and not in multiple threads,
requesting all pages of data will happen one page at a time and the functions
<code class="docutils literal notranslate"><span class="pre">list_all</span></code> and <code class="docutils literal notranslate"><span class="pre">dict_all</span></code> will not return until after the final HTTP
response. Simply put, the functions will take longer to return if the total
number of results is higher.</p>
</section>
<section id="updating-creating-or-deleting-while-paginating">
<h4>Updating, creating or deleting while paginating<a class="headerlink" href="#updating-creating-or-deleting-while-paginating" title="Permalink to this heading">¶</a></h4>
<p>If performing page-wise operations, i.e. making changes immediately after
fetching each page of results, rather than pre-fetching all objects and then
operating on them (i.e. with <a class="reference internal" href="#pdpyras.APISession.list_all" title="pdpyras.APISession.list_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.list_all</span></code></a>), one must be
cautious not to perform any changes to the results that would affect the set
over which iteration is taking place, such as creating objects, deleting them,
or modifying them in such a way that their status of being in the set of
results changes.</p>
<p>This is because indexes’ contents are updated in real time, and this can affect
the position of objects in the overall list (and thus the edges of each page).
Changes made apart from the API client can have the same effect.</p>
<p>To elaborate: let’s say that each resource object in the full list is a page in
a notebook  Classic pagination with <code class="docutils literal notranslate"><span class="pre">limit=100</span></code> is essentially “go through
100 pages, then repeat starting with the 101st page, then with the 201st, etc.”
Deleting records in between these 100-at-a-time pagination requests would be
like tearing out pages after reading them. At the time of the second page
request, what was originally the 101st page before starting will shift to
become the first page after tearing out the first hundred pages. Thus, when
going to the 101st page after finishing tearing out the first hundred pages,
the second hundred pages will be skipped over, and similarly for pages 401-500,
601-700 and so on. If attaching pages, the opposite happens: some results will be
returned more than once, because they get bumped to the next group of 100 pages.</p>
</section>
</section>
<section id="multi-updating">
<h3>Multi-updating<a class="headerlink" href="#multi-updating" title="Permalink to this heading">¶</a></h3>
<p>Introduced in version 2.1 is support for multi-update actions using <code class="docutils literal notranslate"><span class="pre">rput</span></code>.
As of this writing, multi-update support includes the following endpoints:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://developer.pagerduty.com/api-reference/b3A6Mjc0ODEzOQ-manage-incidents">PUT /incidents</a></p></li>
<li><p><a class="reference external" href="https://developer.pagerduty.com/api-reference/b3A6Mjc0ODE0NA-manage-alerts">PUT /incidents/{id}/alerts</a></p></li>
<li><p>PUT /priorities (documentation not yet published as of 2022-03-15, but the endpoint is functional)</p></li>
</ul>
<p>To use, simply pass in a list of objects or references (dictionaries having a
structure according to the API schema reference for that object type) to the
<code class="docutils literal notranslate"><span class="pre">json</span></code> keyword argument of <a class="reference internal" href="#pdpyras.APISession.rput" title="pdpyras.APISession.rput"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.rput</span></code></a>, and the final
payload will be an object with one property named after the resource,
containing that list.</p>
<p>For instance, to resolve two incidents with IDs <code class="docutils literal notranslate"><span class="pre">PABC123</span></code> and <code class="docutils literal notranslate"><span class="pre">PDEF456</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">rput</span><span class="p">(</span>
    <span class="s2">&quot;incidents&quot;</span><span class="p">,</span>
    <span class="n">json</span><span class="o">=</span><span class="p">[</span>
      <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="s1">&#39;PABC123&#39;</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;incident_reference&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">:</span><span class="s1">&#39;resolved&#39;</span><span class="p">},</span>
      <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="s1">&#39;PDEF456&#39;</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;incident_reference&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">:</span><span class="s1">&#39;resolved&#39;</span><span class="p">},</span>
    <span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<p>In this way, a single API request can more efficiently perform multiple update
actions.</p>
<p>It is important to note, however, that certain actions such as updating
incidents require the <code class="docutils literal notranslate"><span class="pre">From</span></code> header, which should be the login email address
of a valid PagerDuty user. To set this, pass it through using the <code class="docutils literal notranslate"><span class="pre">headers</span></code>
keyword argument, or set the <a class="reference internal" href="#pdpyras.APISession.default_from" title="pdpyras.APISession.default_from"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.default_from</span></code></a> property,
or pass the email address as the <code class="docutils literal notranslate"><span class="pre">default_from</span></code> keyword argument when
constructing the session initially.</p>
</section>
<section id="error-handling">
<h3>Error handling<a class="headerlink" href="#error-handling" title="Permalink to this heading">¶</a></h3>
<p>What happens when, for any of the methods that do not return
<a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a>, the API response is a non-success HTTP status, is that it
will not return the decoded body. Instead, when this happens, a
<a class="reference internal" href="#pdpyras.PDClientError" title="pdpyras.PDClientError"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdpyras.PDClientError</span></code></a> exception is raised. This way, methods can
always be expected to return the same structure of data based on the API being
used. If there is a break in this expectation, the flow is appropriately
interrupted.</p>
<p>As of version 2, this exception class has the <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object as
its <code class="docutils literal notranslate"><span class="pre">response</span></code> property (whenever the exception pertains to a HTTP error).
The implementer can thus define specialized error handling logic in which the
REST API response data (i.e. headers, code and body) are directly available.</p>
<p>For instance, the following code prints “User not found” in the event of a 404,
prints out the user’s email if the user exists, raises the underlying
exception if it’s any other HTTP error code, and prints an error otherwise:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
  <span class="n">user</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">rget</span><span class="p">(</span><span class="s2">&quot;/users/PJKL678&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">])</span>

<span class="k">except</span> <span class="n">pdpyras</span><span class="o">.</span><span class="n">PDClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User not found&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">e</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Non-transient network or client error&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Version 4.4.0 introduced a new error subclass, PDHTTPError, in which it can be
assumed that the error pertains to a HTTP request:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
  <span class="n">user</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">rget</span><span class="p">(</span><span class="s2">&quot;/users/PJKL678&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">])</span>

<span class="k">except</span> <span class="n">pdpyras</span><span class="o">.</span><span class="n">PDHTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User not found&quot;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="n">e</span>
<span class="k">except</span> <span class="n">pdpyras</span><span class="o">.</span><span class="n">PDClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Non-transient network or client error&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="http-retry-logic">
<h3>HTTP retry logic<a class="headerlink" href="#http-retry-logic" title="Permalink to this heading">¶</a></h3>
<p>Session objects support retrying API requests if they receive a non-success
response or if they encounter a network error. This behavior is configurable
through the following properties, which are each documented with further
implementation details:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pdpyras.PDSession.max_http_attempts" title="pdpyras.PDSession.max_http_attempts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.PDSession.max_http_attempts</span></code></a></p></li>
<li><p><a class="reference internal" href="#pdpyras.PDSession.max_network_attempts" title="pdpyras.PDSession.max_network_attempts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.PDSession.max_network_attempts</span></code></a></p></li>
<li><p><a class="reference internal" href="#pdpyras.PDSession.sleep_timer" title="pdpyras.PDSession.sleep_timer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.PDSession.sleep_timer</span></code></a></p></li>
<li><p><a class="reference internal" href="#pdpyras.PDSession.sleep_timer_base" title="pdpyras.PDSession.sleep_timer_base"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.PDSession.sleep_timer_base</span></code></a></p></li>
<li><p><a class="reference internal" href="#pdpyras.PDSession.stagger_cooldown" title="pdpyras.PDSession.stagger_cooldown"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.PDSession.stagger_cooldown</span></code></a></p></li>
</ul>
<section id="cooldown">
<h4>Cooldown<a class="headerlink" href="#cooldown" title="Permalink to this heading">¶</a></h4>
<p>After each unsuccessful attempt, if retry logic is active for the given HTTP
status, the client will sleep for a short period that increases exponentially
with each retry.</p>
<p>Let:</p>
<ul class="simple">
<li><p>a = <code class="docutils literal notranslate"><span class="pre">sleep_timer_base</span></code></p></li>
<li><p>t<sub>0</sub> = <code class="docutils literal notranslate"><span class="pre">sleep_timer</span></code></p></li>
<li><p>t<sub>n</sub> = Sleep time after n attempts</p></li>
<li><p>ρ = <code class="docutils literal notranslate"><span class="pre">stagger_cooldown</span></code></p></li>
<li><p>r = a random real number between 0 and 1</p></li>
</ul>
<p>Assuming ρ = 0:</p>
<p>t<sub>n</sub> = t<sub>0</sub> a<sup>n</sup></p>
<p>If ρ is nonzero:</p>
<p>t<sub>n</sub> = a (1 + ρ r) t<sub>n-1</sub></p>
</section>
<section id="rate-limiting">
<h4>Rate Limiting<a class="headerlink" href="#rate-limiting" title="Permalink to this heading">¶</a></h4>
<p>By default, after receiving a status 429 response, sessions will retry the
request indefinitely until it receives a status other than 429. This is a sane
approach; if it is ever responding with 429, the REST API is receiving (for the
given REST API key) too many requests, and the issue should by nature be
transient unless there is a rogue process using the key and saturating its rate
limit.</p>
</section>
<section id="http-retry-configuration">
<h4>HTTP retry configuration<a class="headerlink" href="#http-retry-configuration" title="Permalink to this heading">¶</a></h4>
<p>The property <a class="reference internal" href="#pdpyras.PDSession.retry" title="pdpyras.PDSession.retry"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.PDSession.retry</span></code></a> allows customization of HTTP retry
logic, so that the client can be made to retry on other statuses (i.e.
502/400), up to a set number of times. The total number of HTTP error responses
that the client will tolerate before returning the response object is defined
in <a class="reference internal" href="#pdpyras.PDSession.max_http_attempts" title="pdpyras.PDSession.max_http_attempts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.PDSession.max_http_attempts</span></code></a>, and this will supersede the
maximum number of retries defined in <a class="reference internal" href="#pdpyras.PDSession.retry" title="pdpyras.PDSession.retry"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.PDSession.retry</span></code></a>.</p>
<p><strong>Example:</strong></p>
<p>The following will take about 30 seconds plus API request time
(carrying out four attempts, with 2, 4, 8 and 16 second pauses between them),
before finally returning with the status 404 <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">retry</span><span class="p">[</span><span class="mi">404</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">session</span><span class="o">.</span><span class="n">max_http_attempts</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">session</span><span class="o">.</span><span class="n">sleep_timer</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">session</span><span class="o">.</span><span class="n">sleep_timer_base</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/users/PNOEXST&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="events-api">
<h3>Events API<a class="headerlink" href="#events-api" title="Permalink to this heading">¶</a></h3>
<p>As an added bonus, <code class="docutils literal notranslate"><span class="pre">pdpyras</span></code> provides an additional Session class for submitting
alert data to the Events API and triggering incidents asynchronously:
<a class="reference internal" href="#pdpyras.EventsAPISession" title="pdpyras.EventsAPISession"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdpyras.EventsAPISession</span></code></a>. It has most of the same features as
<a class="reference internal" href="#pdpyras.APISession" title="pdpyras.APISession"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdpyras.APISession</span></code></a>:</p>
<ul class="simple">
<li><p>Connection persistence</p></li>
<li><p>Automatic cooldown and retry in the event of rate limiting or a transient network error</p></li>
<li><p>Setting all required headers</p></li>
<li><p>Configurable HTTP retry logic</p></li>
</ul>
<p>To instantiate a session object, pass the constructor the routing key. Code
samples in this section will assume a variable named <code class="docutils literal notranslate"><span class="pre">session</span></code> constructed in
this way. For example, given an environment variable <code class="docutils literal notranslate"><span class="pre">PD_API_KEY</span></code> set to an
events API v2 (or global event routing) API key:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pdpyras</span>

<span class="n">routing_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PD_API_KEY&#39;</span><span class="p">]</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">pdpyras</span><span class="o">.</span><span class="n">EventsAPISession</span><span class="p">(</span><span class="n">routing_key</span><span class="p">)</span>
</pre></div>
</div>
<p>To transmit alerts and perform actions through the events API, one would use:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pdpyras.EventsAPISession.trigger" title="pdpyras.EventsAPISession.trigger"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.EventsAPISession.trigger</span></code></a></p></li>
<li><p><a class="reference internal" href="#pdpyras.EventsAPISession.acknowledge" title="pdpyras.EventsAPISession.acknowledge"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.EventsAPISession.acknowledge</span></code></a></p></li>
<li><p><a class="reference internal" href="#pdpyras.EventsAPISession.resolve" title="pdpyras.EventsAPISession.resolve"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.EventsAPISession.resolve</span></code></a></p></li>
</ul>
<p><strong>Example 1:</strong> Trigger an event and use the PagerDuty-supplied deduplication key to resolve it later:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dedup_key</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="s2">&quot;Server is on fire&quot;</span><span class="p">,</span> <span class="s1">&#39;dusty.old.server.net&#39;</span><span class="p">)</span>
<span class="c1"># ...</span>
<span class="n">session</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">dedup_key</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Example 2:</strong> Trigger an event, specifying a dedup key, and use it to later acknowledge the incident</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="s2">&quot;Server is on fire&quot;</span><span class="p">,</span> <span class="s1">&#39;dusty.old.server.net&#39;</span><span class="p">,</span>
    <span class="n">dedup_key</span><span class="o">=</span><span class="s1">&#39;abc123&#39;</span><span class="p">)</span>
<span class="c1"># ...</span>
<span class="n">session</span><span class="o">.</span><span class="n">acknowledge</span><span class="p">(</span><span class="s1">&#39;abc123&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="change-events-api">
<h3>Change Events API<a class="headerlink" href="#change-events-api" title="Permalink to this heading">¶</a></h3>
<p>To submit a change event, create an instance of
<a class="reference internal" href="#pdpyras.ChangeEventsAPISession" title="pdpyras.ChangeEventsAPISession"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdpyras.ChangeEventsAPISession</span></code></a>, passing an Events API v2 key to the
class constructor as with <code class="xref py py-class docutils literal notranslate"><span class="pre">EventsAPISession</span></code>. Then, call
<a class="reference internal" href="#pdpyras.ChangeEventsAPISession.submit" title="pdpyras.ChangeEventsAPISession.submit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.ChangeEventsAPISession.submit</span></code></a>, i.e.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="s2">&quot;new build finished at latest HEAD&quot;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;automation&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Permalink to this heading">¶</a></h2>
<p>Bug reports and pull requests to fix issues are always welcome, as are
contributions to the built-in documentation.</p>
<p>If adding features, or making changes, it is recommended to update or add tests
and assertions to the appropriate test case class in <code class="docutils literal notranslate"><span class="pre">test_pdpyras.py</span></code> to ensure
code coverage. If the change(s) fix a bug, please add assertions that reproduce
the bug along with code changes themselves, and include the GitHub issue number
in the commit message.</p>
</section>
<section id="releasing">
<h2>Releasing<a class="headerlink" href="#releasing" title="Permalink to this heading">¶</a></h2>
<p>(Target audience: package maintainers)</p>
<section id="initial-setup">
<h3>Initial Setup<a class="headerlink" href="#initial-setup" title="Permalink to this heading">¶</a></h3>
<p>To be able to rebuild the documentation and release a new version, first make
sure you have <a class="reference external" href="https://www.gnu.org/software/make/">make</a> and <a class="reference external" href="https://pip.pypa.io/en/stable/installation/">pip</a> installed in your shell
environment.</p>
<p>Next, install Python dependencies for building and publishing:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip install -r requirements-publish.txt
</pre></div>
</div>
</section>
<section id="before-publishing">
<h3>Before publishing<a class="headerlink" href="#before-publishing" title="Permalink to this heading">¶</a></h3>
<p>You will need valid user accounts on both <code class="docutils literal notranslate"><span class="pre">pypi.org</span></code> and <code class="docutils literal notranslate"><span class="pre">test.pypi.org</span></code>
that have the “Maintainer” role on the project.</p>
<section id="perform-end-to-end-publish-and-installation-testing">
<h4>Perform end-to-end publish and installation testing<a class="headerlink" href="#perform-end-to-end-publish-and-installation-testing" title="Permalink to this heading">¶</a></h4>
<p>To test publishing and installing from the package index, first make sure you
have a valid user account on <code class="docutils literal notranslate"><span class="pre">test.pypi.org</span></code> that has publisher access to the
project as on <code class="docutils literal notranslate"><span class="pre">pypi.org</span></code>. Then, entering your credentials when prompted, run:</p>
<p>… code-block:: shell</p>
<blockquote>
<div><p>make testpublish</p>
</div></blockquote>
<p>The make target <code class="docutils literal notranslate"><span class="pre">testpublish</span></code> performs the following:</p>
<ul class="simple">
<li><p>Build the Python egg in <code class="docutils literal notranslate"><span class="pre">dist/</span></code></p></li>
<li><p>Upload the new library to <code class="docutils literal notranslate"><span class="pre">test.pypi.org</span></code></p></li>
<li><p>Test-install the library from <code class="docutils literal notranslate"><span class="pre">test.pypi.org</span></code> into a temporary Python
virtualenv that does not already have the library installed, to test
installing for the first time</p></li>
<li><p>Tests-installs the library from <code class="docutils literal notranslate"><span class="pre">test.pypi.org</span></code> into a temporary Python
virtualenv where the library is already installed, to test upgrading</p></li>
</ul>
<p>If any errors are encountered, they should be addressed first before publishing.</p>
<p>To test again, first delete the new release that was previously uploaded:</p>
<ol class="arabic simple">
<li><p>Log in to <code class="docutils literal notranslate"><span class="pre">test.pypi.org</span></code></p></li>
<li><p>Go to <a class="reference external" href="https://test.pypi.org/manage/project/pdpyras/releases/">https://test.pypi.org/manage/project/pdpyras/releases/</a></p></li>
<li><p>Select “Delete” from the options menu to the right of the new release</p></li>
</ol>
</section>
<section id="merge-changes-and-tag">
<h4>Merge changes and tag<a class="headerlink" href="#merge-changes-and-tag" title="Permalink to this heading">¶</a></h4>
<p>A pull request for releasing a new version should be created, which along with
the functional changes should also include at least:</p>
<ul class="simple">
<li><p>An update to CHANGELOG.rst, where all lines corresponding to community
contributions end with (in parentheses) the GitHub user handle of the
contributor, a slash, and a link to the pull request.</p></li>
<li><p>A change in the version number in both setup.py and pdpyras.py, to a new
version that follows <a class="reference external" href="https://semver.org/">Semantic Versioning</a>.</p></li>
<li><p>Rebuilt HTML documentation</p></li>
</ul>
<p>The HTML documentation can be rebuilt with the <code class="docutils literal notranslate"><span class="pre">docs</span></code> make target:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>make docs
</pre></div>
</div>
<p>After rebuilding the documentation, it can then be viewed by opening the file
<code class="docutils literal notranslate"><span class="pre">docs/index.html</span></code> in a web browser. Including rebuilt documentation helps
reviewers by not requiring them to have the documentation-building tools
installed.</p>
<p>Once the pull request is approved, merge, then checkout main and tag:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git checkout main <span class="o">&amp;&amp;</span> <span class="se">\</span>
  git pull origin main <span class="o">&amp;&amp;</span> <span class="se">\</span>
  git tag <span class="s2">&quot;v</span><span class="k">$(</span>python -c <span class="s1">&#39;from pdpyras import __version__; print(__version__)&#39;</span><span class="k">)</span><span class="s2">&quot;</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
  git push --tags origin main
</pre></div>
</div>
</section>
</section>
<section id="publishing-a-new-version">
<h3>Publishing a new version<a class="headerlink" href="#publishing-a-new-version" title="Permalink to this heading">¶</a></h3>
<p>Once the changes are merged and tagged, make sure your local repository clone
has the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch checked out at the latest avialable commit, and the
local file tree is clean (has no uncommitted changes). Then run:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>make publish
</pre></div>
</div>
</section>
</section>
<section id="developer-interface">
<h2>Developer Interface<a class="headerlink" href="#developer-interface" title="Permalink to this heading">¶</a></h2>
<p>API client classes supplied by this library are not intended as replacements
for API documentation or wrappers of PagerDuty’s APIs, but rather wrappers of the
HTTP client (<a class="reference external" href="https://docs.python-requests.org/en/master/api/#request-sessions">requests.Session</a>) that make it easier to use PagerDuty’s APIs.</p>
<section id="generic-api-client">
<h3>Generic API Client<a class="headerlink" href="#generic-api-client" title="Permalink to this heading">¶</a></h3>
<p>This base class implements features common to all API client classes.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pdpyras.PDSession">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pdpyras.</span></span><span class="sig-name descname"><span class="pre">PDSession</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.PDSession" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for making HTTP requests to PagerDuty APIs.</p>
<p>Instances of this class are essentially the same as <a class="reference external" href="https://docs.python-requests.org/en/master/api/#request-sessions">requests.Session</a>
objects, but with a few modifications:</p>
<ul class="simple">
<li><p>The client will reattempt the request with configurable, auto-increasing
cooldown/retry intervals if encountering a network error or rate limit</p></li>
<li><p>When making requests, headers specified ad-hoc in calls to HTTP verb
functions will not replace, but will be merged with, default headers.</p></li>
<li><p>The request URL, if it doesn’t already start with the REST API base URL,
will be prepended with the default REST API base URL.</p></li>
<li><p>It will only perform requests with methods as given in the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">permitted_methods</span></code> list, and will raise <a class="reference internal" href="#pdpyras.PDClientError" title="pdpyras.PDClientError"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDClientError</span></code></a> for
any other HTTP methods.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.PDSession.after_set_api_key">
<span class="sig-name descname"><span class="pre">after_set_api_key</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.PDSession.after_set_api_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter hook for setting or updating the API key.</p>
<p>Child classes should implement this to perform additional steps.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pdpyras.PDSession.api_key">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">api_key</span></span><a class="headerlink" href="#pdpyras.PDSession.api_key" title="Permalink to this definition">¶</a></dt>
<dd><p>API Key property getter.</p>
<p>Returns the _api_key attribute’s value.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pdpyras.PDSession.auth_header">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">auth_header</span></span><a class="headerlink" href="#pdpyras.PDSession.auth_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the header with the API credential used for authentication.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pdpyras.PDSession.log">
<span class="sig-name descname"><span class="pre">log</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pdpyras.PDSession.log" title="Permalink to this definition">¶</a></dt>
<dd><p>A <code class="docutils literal notranslate"><span class="pre">logging.Logger</span></code> object for printing messages.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pdpyras.PDSession.max_http_attempts">
<span class="sig-name descname"><span class="pre">max_http_attempts</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#pdpyras.PDSession.max_http_attempts" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of times that the client will retry after error statuses, for any
that are defined greater than zero in <a class="reference internal" href="#pdpyras.PDSession.retry" title="pdpyras.PDSession.retry"><code class="xref py py-attr docutils literal notranslate"><span class="pre">retry</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pdpyras.PDSession.max_network_attempts">
<span class="sig-name descname"><span class="pre">max_network_attempts</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#pdpyras.PDSession.max_network_attempts" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of times that connecting to the API will be attempted before
treating the failure as non-transient; a <a class="reference internal" href="#pdpyras.PDClientError" title="pdpyras.PDClientError"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDClientError</span></code></a> exception
will be raised if this happens.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.PDSession.normalize_params">
<span class="sig-name descname"><span class="pre">normalize_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.PDSession.normalize_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify the user-supplied parameters.</p>
<p>Current behavior:</p>
<ul class="simple">
<li><p>If a parameter’s value is of type list, and the parameter name does
not already end in “[]”, then the square brackets are appended to keep
in line with the requirement that all set filters’ parameter names end
in “[]”.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.PDSession.normalize_url">
<span class="sig-name descname"><span class="pre">normalize_url</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.PDSession.normalize_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Compose the URL whether it is a path or an already-complete URL</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pdpyras.PDSession.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pdpyras.PDSession.parent" title="Permalink to this definition">¶</a></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">super</span></code> object (<a class="reference external" href="https://docs.python-requests.org/en/master/api/#request-sessions">requests.Session</a>)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.PDSession.postprocess">
<span class="sig-name descname"><span class="pre">postprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.PDSession.postprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform supplemental actions immediately after receiving a response.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.PDSession.prepare_headers">
<span class="sig-name descname"><span class="pre">prepare_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.PDSession.prepare_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Append special additional per-request headers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> – The HTTP method, in upper case.</p></li>
<li><p><strong>user_headers</strong> – Headers that can be specified to override default values.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pdpyras.PDSession.raise_if_http_error">
<span class="sig-name descname"><span class="pre">raise_if_http_error</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pdpyras.PDSession.raise_if_http_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise an exception upon receiving an error response from the server.</p>
<p>This affects iteration (in the REST API) as well as the generic request
method itself.</p>
<p>In the general case: if set to True, then upon receiving a non-transient
HTTP error (from too many retries), an exception will be raised. Otherwise,
the response object will be returned.</p>
<p>In iteration: if set to true, an exception will be raised in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">iter_all</span></code> if a HTTP error is encountered. This is the default
behavior in versions &gt;= 2.1.0.  If False, the behavior is to halt iteration
upon receiving a HTTP error.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.PDSession.request">
<span class="sig-name descname"><span class="pre">request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.PDSession.request" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a generic PagerDuty API request.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – The request method to use. Case-insensitive. May be one of get, put,
post or delete.</p></li>
<li><p><strong>url</strong> (<em>str</em>) – The path/URL to request. If it does not start with the base URL, the
base URL will be prepended.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to pass to <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Session.request">requests.Session.request</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the HTTP response object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pdpyras.PDSession.retry">
<span class="sig-name descname"><span class="pre">retry</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#pdpyras.PDSession.retry" title="Permalink to this definition">¶</a></dt>
<dd><p>A dict defining the retry behavior for each HTTP response status code.</p>
<p>Note, any value set for this class variable will not be reflected in
instances and so it must be set separately for each instance.</p>
<p>Each key in this dictionary represents a HTTP response code. The behavior is
specified by the value at each key as follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-1</span></code> to retry infinitely</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> to return the <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object and exit (which is the
default behavior)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code>, where <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>, to retry <code class="docutils literal notranslate"><span class="pre">n</span></code> times (or up
to <a class="reference internal" href="#pdpyras.PDSession.max_http_attempts" title="pdpyras.PDSession.max_http_attempts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">max_http_attempts</span></code></a> total for all statuses, whichever is
encountered first), and raise a <a class="reference internal" href="#pdpyras.PDClientError" title="pdpyras.PDClientError"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDClientError</span></code></a> after that many
attempts. For each successive attempt, the wait time will increase by a
factor of <a class="reference internal" href="#pdpyras.PDSession.sleep_timer_base" title="pdpyras.PDSession.sleep_timer_base"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sleep_timer_base</span></code></a>.</p></li>
</ul>
<p>The default behavior is to retry infinitely on a 429, and return the
response in any other case (assuming a HTTP response was received from the
server).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.PDSession.set_api_key">
<span class="sig-name descname"><span class="pre">set_api_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api_key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.PDSession.set_api_key" title="Permalink to this definition">¶</a></dt>
<dd><p>(Deprecated) set the API key/token.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>api_key</strong> (<em>str</em>) – The API key to use</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pdpyras.PDSession.sleep_timer">
<span class="sig-name descname"><span class="pre">sleep_timer</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.5</span></em><a class="headerlink" href="#pdpyras.PDSession.sleep_timer" title="Permalink to this definition">¶</a></dt>
<dd><p>Default initial cooldown time factor for rate limiting and network errors.</p>
<p>Each time that the request makes a followup request, there will be a delay
in seconds equal to this number times <a class="reference internal" href="#pdpyras.PDSession.sleep_timer_base" title="pdpyras.PDSession.sleep_timer_base"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sleep_timer_base</span></code></a> to the power
of how many attempts have already been made so far.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pdpyras.PDSession.sleep_timer_base">
<span class="sig-name descname"><span class="pre">sleep_timer_base</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#pdpyras.PDSession.sleep_timer_base" title="Permalink to this definition">¶</a></dt>
<dd><p>After each retry, the time to sleep before reattempting the API connection
and request will increase by a factor of this amount.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pdpyras.PDSession.stagger_cooldown">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stagger_cooldown</span></span><a class="headerlink" href="#pdpyras.PDSession.stagger_cooldown" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomizing factor for wait times between retries during rate limiting.</p>
<p>If set to number greater than 0, the sleep time for rate limiting will
(for each successive sleep) be adjusted by a factor of one plus a
uniformly-distributed random number between 0 and 1 times this number,
on top of the base sleep timer <a class="reference internal" href="#pdpyras.PDSession.sleep_timer_base" title="pdpyras.PDSession.sleep_timer_base"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sleep_timer_base</span></code></a>.</p>
<p>For example:</p>
<ul class="simple">
<li><p>If this is 1, and <a class="reference internal" href="#pdpyras.PDSession.sleep_timer_base" title="pdpyras.PDSession.sleep_timer_base"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sleep_timer_base</span></code></a> is 2 (default), then after
each status 429 response, the sleep time will change overall by a
random factor between 2 and 4, whereas if it is zero, it will change
by a factor of 2.</p></li>
<li><p>If <a class="reference internal" href="#pdpyras.PDSession.sleep_timer_base" title="pdpyras.PDSession.sleep_timer_base"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sleep_timer_base</span></code></a> is 1, then the cooldown time will be
adjusted by a random factor between one and one plus this number.</p></li>
</ul>
<p>If the number is set to zero, then this behavior is effectively
disabled, and the cooldown factor (by which the sleep time is adjusted)
will just be <a class="reference internal" href="#pdpyras.PDSession.sleep_timer_base" title="pdpyras.PDSession.sleep_timer_base"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sleep_timer_base</span></code></a></p>
<p>Setting this to a nonzero number helps avoid the “thundering herd”
effect that can potentially be caused by many API clients making
simultaneous concurrent API requests and consequently waiting for the
same amount of time before retrying.  It is currently zero by default
for consistent behavior with previous versions.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pdpyras.PDSession.timeout">
<span class="sig-name descname"><span class="pre">timeout</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">60</span></em><a class="headerlink" href="#pdpyras.PDSession.timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the value sent to <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Session.request">requests.Session.request</a> as the <code class="docutils literal notranslate"><span class="pre">timeout</span></code>
parameter that determines the TCP read timeout.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pdpyras.PDSession.trunc_key">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">trunc_key</span></span><a class="headerlink" href="#pdpyras.PDSession.trunc_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Truncated key for secure display/identification purposes.</p>
</dd></dl>

</dd></dl>

</section>
<section id="rest-api-client">
<h3>REST API Client<a class="headerlink" href="#rest-api-client" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pdpyras.APISession">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pdpyras.</span></span><span class="sig-name descname"><span class="pre">APISession</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_from</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auth_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'token'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession" title="Permalink to this definition">¶</a></dt>
<dd><p>Reusable PagerDuty REST API session objects for making API requests.</p>
<p>Implements features to facilitate usage of the REST API. For more details on
how to use each resource type’s API, see the <a class="reference external" href="https://developer.pagerduty.com/api-reference/">REST API Reference</a>.</p>
<p>Includes some convenience functions as well, i.e. <a class="reference internal" href="#pdpyras.APISession.rget" title="pdpyras.APISession.rget"><code class="xref py py-attr docutils literal notranslate"><span class="pre">rget</span></code></a>, <a class="reference internal" href="#pdpyras.APISession.find" title="pdpyras.APISession.find"><code class="xref py py-attr docutils literal notranslate"><span class="pre">find</span></code></a>
and <a class="reference internal" href="#pdpyras.APISession.iter_all" title="pdpyras.APISession.iter_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iter_all</span></code></a>, to eliminate some repetitive tasks associated with
API usage.</p>
<p>Inherits from <a class="reference internal" href="#pdpyras.PDSession" title="pdpyras.PDSession"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDSession</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>api_key</strong> – REST API access token to use for HTTP requests</p></li>
<li><p><strong>name</strong> (<em>str</em><em> or </em><em>None</em>) – Optional name identifier for logging. If unspecified or <code class="docutils literal notranslate"><span class="pre">None</span></code>, it
will be the last four characters of the REST API token.</p></li>
<li><p><strong>default_from</strong> (<em>str</em><em> or </em><em>None</em>) – Email address of a valid PagerDuty user to use in API requests by
default as the <code class="docutils literal notranslate"><span class="pre">From</span></code> header (see: <a class="reference external" href="https://v2.developer.pagerduty.com/docs/rest-api#http-request-headers">HTTP Request Headers</a>)</p></li>
</ul>
</dd>
<dt class="field-even">Members<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.APISession.rdelete">
<span class="sig-name descname"><span class="pre">rdelete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">\*\*kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.rdelete" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.APISession.rget">
<span class="sig-name descname"><span class="pre">rget</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">\*\*kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.rget" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.APISession.rpost">
<span class="sig-name descname"><span class="pre">rpost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">\*\*kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.rpost" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.APISession.rput">
<span class="sig-name descname"><span class="pre">rput</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">\*\*kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.rput" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.APISession.after_set_api_key">
<span class="sig-name descname"><span class="pre">after_set_api_key</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.after_set_api_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Setter hook for setting or updating the API key.</p>
<p>Child classes should implement this to perform additional steps.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pdpyras.APISession.api_call_counts">
<span class="sig-name descname"><span class="pre">api_call_counts</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pdpyras.APISession.api_call_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>A dict object recording the number of API calls per endpoint</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pdpyras.APISession.api_key_access">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">api_key_access</span></span><a class="headerlink" href="#pdpyras.APISession.api_key_access" title="Permalink to this definition">¶</a></dt>
<dd><p>Memoized API key access type getter.</p>
<p>Will be “user” if the API key is a user-level token (all users should
have permission to create an API key with the same permissions as they
have in the PagerDuty web UI).</p>
<p>If the API key in use is an account-level API token (as only a global
administrator user can create), this property will be “account”.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pdpyras.APISession.api_time">
<span class="sig-name descname"><span class="pre">api_time</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pdpyras.APISession.api_time" title="Permalink to this definition">¶</a></dt>
<dd><p>A dict object recording the total time of API calls to each endpoint</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pdpyras.APISession.auth_header">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">auth_header</span></span><a class="headerlink" href="#pdpyras.APISession.auth_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the header with the API credential used for authentication.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pdpyras.APISession.auth_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">auth_type</span></span><a class="headerlink" href="#pdpyras.APISession.auth_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the method of API authentication.</p>
<p>By default this is “token”; if “oauth2”, the API key will be used.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pdpyras.APISession.default_from">
<span class="sig-name descname"><span class="pre">default_from</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pdpyras.APISession.default_from" title="Permalink to this definition">¶</a></dt>
<dd><p>The default value to use as the <code class="docutils literal notranslate"><span class="pre">From</span></code> request header</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pdpyras.APISession.default_page_size">
<span class="sig-name descname"><span class="pre">default_page_size</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">100</span></em><a class="headerlink" href="#pdpyras.APISession.default_page_size" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be the default number of results requested in each page when
iterating/querying an index (the <code class="docutils literal notranslate"><span class="pre">limit</span></code> parameter). See: <a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTU4-pagination">pagination</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.APISession.dict_all">
<span class="sig-name descname"><span class="pre">dict_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.dict_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of all objects from a given index endpoint.</p>
<p>With the exception of <code class="docutils literal notranslate"><span class="pre">by</span></code>, all keyword arguments passed to this
method are also passed to <a class="reference internal" href="#pdpyras.APISession.iter_all" title="pdpyras.APISession.iter_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iter_all</span></code></a>; see the documentation on
that method for further details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – The index endpoint URL to use.</p></li>
<li><p><strong>by</strong> – The attribute of each object to use for the key values of the
dictionary. This is <code class="docutils literal notranslate"><span class="pre">id</span></code> by default. Please note, there is no
uniqueness validation, so if you use an attribute that is not
distinct for the data set, this function will omit some data in the
results.</p></li>
<li><p><strong>params</strong> – Additional URL parameters to include.</p></li>
<li><p><strong>paginate</strong> – If True, use <a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTU4-pagination">pagination</a> to get through all available results. If
False, ignore / don’t page through more than the first 100 results.
Useful for special index endpoints that don’t fully support
pagination yet, i.e. “nested” endpoints like
<code class="docutils literal notranslate"><span class="pre">/users/{id}/contact_methods</span></code> and <code class="docutils literal notranslate"><span class="pre">/services/{id}/integrations</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.APISession.find">
<span class="sig-name descname"><span class="pre">find</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.find" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds an object of a given resource type exactly matching a query.</p>
<p>Returns a dict if a result is found. The structure will be that of an
entry in the index endpoint schema’s array of results. Otherwise, it
will return <code class="docutils literal notranslate"><span class="pre">None</span></code> if no result is found or an error is encountered.</p>
<p>Works by querying a given <a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTU0-endpoints#resources-index">resource index</a> endpoint using the <code class="docutils literal notranslate"><span class="pre">query</span></code>
parameter. To use this function on any given resource, the resource’s
index must support the <code class="docutils literal notranslate"><span class="pre">query</span></code> parameter; otherwise, the function may
not work as expected. If the index ignores the parameter, for instance,
this function will take much longer to return; results will not be
constrained to those matching the query, and so every result in the
index will be downloaded and compared against the query up until a
matching result is found or all results have been checked.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource</strong> (<em>str</em>) – The name of the resource endpoint to query, i.e.
<code class="docutils literal notranslate"><span class="pre">escalation_policies</span></code></p></li>
<li><p><strong>query</strong> (<em>str</em>) – The string to query for in the the index.</p></li>
<li><p><strong>attribute</strong> (<em>str</em>) – The property of each result to compare against the query value when
searching for an exact match. By default it is <code class="docutils literal notranslate"><span class="pre">name</span></code>, but when
searching for user by email (for example) it can be set to <code class="docutils literal notranslate"><span class="pre">email</span></code></p></li>
<li><p><strong>params</strong> (<em>dict</em><em> or </em><em>None</em>) – Optional additional parameters to use when querying.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.APISession.iter_all">
<span class="sig-name descname"><span class="pre">iter_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paginate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">page_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_hook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.iter_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator for the contents of an index endpoint or query.</p>
<p>Automatically paginates and yields the results in each page, until all
matching results have been yielded or a HTTP error response is received.</p>
<p>Each yielded value is a dict object representing a result returned from
the index. For example, if requesting the <code class="docutils literal notranslate"><span class="pre">/users</span></code> endpoint, each
yielded value will be an entry of the <code class="docutils literal notranslate"><span class="pre">users</span></code> array property in the
response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – The index endpoint URL to use.</p></li>
<li><p><strong>params</strong> (<em>dict</em><em> or </em><em>None</em>) – Additional URL parameters to include.</p></li>
<li><p><strong>paginate</strong> (<em>bool</em>) – If True, use <a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTU4-pagination">pagination</a> to get through all available results. If
False, ignore / don’t page through more than the first 100 results.
Useful for special index endpoints that don’t fully support
pagination yet, i.e. “nested” endpoints like (as of this writing):
<code class="docutils literal notranslate"><span class="pre">/users/{id}/contact_methods</span></code> and <code class="docutils literal notranslate"><span class="pre">/services/{id}/integrations</span></code></p></li>
<li><p><strong>page_size</strong> (<em>int</em><em> or </em><em>None</em>) – If set, the <code class="docutils literal notranslate"><span class="pre">page_size</span></code> argument will override the <code class="docutils literal notranslate"><span class="pre">default_page_size</span></code>
parameter on the session and set the <code class="docutils literal notranslate"><span class="pre">limit</span></code> parameter to a custom
value (default is 100), altering the number of pagination results.</p></li>
<li><p><strong>item_hook</strong> – Callable object that will be invoked for each iteration, i.e. for
printing progress. It will be called with three parameters: a dict
representing a given result in the iteration, the number of the
item, and the total number of items in the series.</p></li>
<li><p><strong>total</strong> (<em>bool</em>) – If True, the <code class="docutils literal notranslate"><span class="pre">total</span></code> parameter will be included in API calls, and
the value for the third parameter to the item hook will be the total
count of records that match the query. Leaving this as False confers
a small performance advantage, as the API in this case does not have
to compute the total count of results in the query.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p>Results from the index endpoint.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.APISession.iter_cursor">
<span class="sig-name descname"><span class="pre">iter_cursor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.iter_cursor" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator for results from an endpoint supporting cursor-based pagination</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – The index endpoint URL to use.</p></li>
<li><p><strong>attribute</strong> – The property in the JSON body, i.e. <code class="docutils literal notranslate"><span class="pre">records</span></code> for
<code class="docutils literal notranslate"><span class="pre">/audit/records</span></code>, in which to find results. If None is specified,
a guess will be made as to the envelope name (that it is the same as
the last node in the URI path).</p></li>
<li><p><strong>params</strong> – Query parameters to include in the request.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.APISession.list_all">
<span class="sig-name descname"><span class="pre">list_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.list_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all objects from a given index endpoint.</p>
<p>All keyword arguments passed to this function are also passed directly
to <a class="reference internal" href="#pdpyras.APISession.iter_all" title="pdpyras.APISession.iter_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iter_all</span></code></a>; see the documentation on that method for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> – The index endpoint URL to use.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.APISession.persist">
<span class="sig-name descname"><span class="pre">persist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.persist" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds or creates and returns a resource with a matching attribute</p>
<p>Given a resource name, an attribute to use as an idempotency key and a
set of attribute:value pairs as a dict, create a resource with the
specified attributes if it doesn’t exist already and return the resource
persisted via the API (whether or not it already existed).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource</strong> (<em>str</em>) – The resource name. Must be a valid API resource that is supported by
the <code class="docutils literal notranslate"><span class="pre">r*</span></code> methods; see <a class="reference internal" href="#supported-endpoints"><span class="std std-ref">Supported endpoints</span></a>.</p></li>
<li><p><strong>attr</strong> (<em>str</em>) – Name of the attribute to use as the idempotency key. For instance,
“email” when the resource is “users” will not create the user if a
user with the email address given in <code class="docutils literal notranslate"><span class="pre">values</span></code> already exists.</p></li>
<li><p><strong>values</strong> (<em>dict</em>) – The content of the resource to be created, if it does not already
exist. This must contain an item with a key that is the same as the
<code class="docutils literal notranslate"><span class="pre">attr</span></code> argument.</p></li>
<li><p><strong>update</strong> (<em>bool</em>) – (New in 4.4.0) If set to True, any existing resource will be updated
with the values supplied.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.APISession.postprocess">
<span class="sig-name descname"><span class="pre">postprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">response</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.postprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Records performance information / request metadata about the API call.</p>
<p>This method is called automatically by <code class="xref py py-func docutils literal notranslate"><span class="pre">request()</span></code> for all requests,
and can be extended in child classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>response</strong> (<a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a>) – The <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object returned by
<a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Session.request">requests.Session.request</a></p></li>
<li><p><strong>suffix</strong> (<em>str</em><em> or </em><em>None</em>) – Optional suffix to append to the key</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.APISession.prepare_headers">
<span class="sig-name descname"><span class="pre">prepare_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.prepare_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Append special additional per-request headers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> – The HTTP method, in upper case.</p></li>
<li><p><strong>user_headers</strong> – Headers that can be specified to override default values.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.APISession.profiler_key">
<span class="sig-name descname"><span class="pre">profiler_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.profiler_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a fixed-format key to classify a request, i.e. for profiling.</p>
<p>Returns a string that will have all instances of IDs replaced with
<code class="docutils literal notranslate"><span class="pre">{id}</span></code>, and will begin with the method in lower case followed by a
colon, i.e. <code class="docutils literal notranslate"><span class="pre">get:escalation_policies/{id}</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – The request method</p></li>
<li><p><strong>path</strong> (<em>str</em>) – The path/URI to classify</p></li>
<li><p><strong>suffix</strong> (<em>str</em>) – Optional suffix to append to the key</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pdpyras.APISession.subdomain">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">subdomain</span></span><a class="headerlink" href="#pdpyras.APISession.subdomain" title="Permalink to this definition">¶</a></dt>
<dd><p>Subdomain of the PagerDuty account of the API access token.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pdpyras.APISession.total_call_count">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_call_count</span></span><a class="headerlink" href="#pdpyras.APISession.total_call_count" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number of API calls made by this instance.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pdpyras.APISession.total_call_time">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_call_time</span></span><a class="headerlink" href="#pdpyras.APISession.total_call_time" title="Permalink to this definition">¶</a></dt>
<dd><p>The total time spent making API calls.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pdpyras.APISession.trunc_token">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">trunc_token</span></span><a class="headerlink" href="#pdpyras.APISession.trunc_token" title="Permalink to this definition">¶</a></dt>
<dd><p>Truncated token for secure display/identification purposes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pdpyras.APISession.url">
<span class="sig-name descname"><span class="pre">url</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'https://api.pagerduty.com'</span></em><a class="headerlink" href="#pdpyras.APISession.url" title="Permalink to this definition">¶</a></dt>
<dd><p>Base URL of the REST API</p>
</dd></dl>

</dd></dl>

</section>
<section id="events-api-client">
<h3>Events API Client<a class="headerlink" href="#events-api-client" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pdpyras.EventsAPISession">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pdpyras.</span></span><span class="sig-name descname"><span class="pre">EventsAPISession</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.EventsAPISession" title="Permalink to this definition">¶</a></dt>
<dd><p>Session class for submitting events to the PagerDuty v2 Events API.</p>
<p>Implements methods for submitting events to PagerDuty through the Events API
and inherits from <a class="reference internal" href="#pdpyras.PDSession" title="pdpyras.PDSession"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdpyras.PDSession</span></code></a>.  For more details on usage of
this API, refer to the <a class="reference external" href="https://developer.pagerduty.com/docs/events-api-v2/overview/">Events API v2 documentation</a></p>
<p>Inherits from <a class="reference internal" href="#pdpyras.PDSession" title="pdpyras.PDSession"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDSession</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.EventsAPISession.acknowledge">
<span class="sig-name descname"><span class="pre">acknowledge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dedup_key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.EventsAPISession.acknowledge" title="Permalink to this definition">¶</a></dt>
<dd><p>Acknowledge an alert via Events API.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dedup_key</strong> – The deduplication key of the alert to set to the acknowledged state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pdpyras.EventsAPISession.auth_header">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">auth_header</span></span><a class="headerlink" href="#pdpyras.EventsAPISession.auth_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the header with the API credential used for authentication.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.EventsAPISession.post">
<span class="sig-name descname"><span class="pre">post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.EventsAPISession.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Override of <code class="docutils literal notranslate"><span class="pre">requests.Session.post</span></code></p>
<p>Adds the <code class="docutils literal notranslate"><span class="pre">routing_key</span></code> parameter to the body before sending.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.EventsAPISession.prepare_headers">
<span class="sig-name descname"><span class="pre">prepare_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.EventsAPISession.prepare_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Add user agent and content type headers for Events API requests.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>user_headers</strong> – User-supplied headers that will override defaults</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.EventsAPISession.resolve">
<span class="sig-name descname"><span class="pre">resolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dedup_key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.EventsAPISession.resolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolve an alert via Events API.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dedup_key</strong> – The deduplication key of the alert to resolve.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.EventsAPISession.send_event">
<span class="sig-name descname"><span class="pre">send_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dedup_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">properties</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.EventsAPISession.send_event" title="Permalink to this definition">¶</a></dt>
<dd><p>Send an event to the v2 Events API.</p>
<p>See: <a class="reference external" href="https://v2.developer.pagerduty.com/docs/send-an-event-events-api-v2">https://v2.developer.pagerduty.com/docs/send-an-event-events-api-v2</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action</strong> (<em>str</em>) – The action to perform through the Events API: trigger, acknowledge
or resolve.</p></li>
<li><p><strong>dedup_key</strong> (<em>str</em>) – The deduplication key; used for determining event uniqueness and
associating actions with existing incidents.</p></li>
<li><p><strong>**properties</strong> – Additional properties to set, i.e. if <code class="docutils literal notranslate"><span class="pre">action</span></code> is <code class="docutils literal notranslate"><span class="pre">trigger</span></code>
this would include <code class="docutils literal notranslate"><span class="pre">payload</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The deduplication key of the incident, if any.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.EventsAPISession.trigger">
<span class="sig-name descname"><span class="pre">trigger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">summary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dedup_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">severity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'critical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">payload</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_details</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">links</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.EventsAPISession.trigger" title="Permalink to this definition">¶</a></dt>
<dd><p>Trigger an incident</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>summary</strong> (<em>str</em>) – Summary / brief description of what is wrong.</p></li>
<li><p><strong>source</strong> (<em>str</em>) – A human-readable name identifying the system that is affected.</p></li>
<li><p><strong>dedup_key</strong> (<em>str</em>) – The deduplication key; used for determining event uniqueness and
associating actions with existing incidents.</p></li>
<li><p><strong>severity</strong> (<em>str</em>) – Alert severity. Sets the <code class="docutils literal notranslate"><span class="pre">payload.severity</span></code> property.</p></li>
<li><p><strong>payload</strong> (<em>dict</em>) – Set the payload directly. Can be used in conjunction with other
parameters that also set payload properties; these properties will
be merged into the default payload, and any properties in this
parameter will take precedence except with regard to
<code class="docutils literal notranslate"><span class="pre">custom_details</span></code>.</p></li>
<li><p><strong>custom_details</strong> (<em>dict</em>) – The <code class="docutils literal notranslate"><span class="pre">payload.custom_details</span></code> property of the payload. Will
override the property set in the <code class="docutils literal notranslate"><span class="pre">payload</span></code> parameter if given.</p></li>
<li><p><strong>images</strong> (<em>list</em>) – Set the <code class="docutils literal notranslate"><span class="pre">images</span></code> property of the event.</p></li>
<li><p><strong>links</strong> (<em>list</em>) – Set the <code class="docutils literal notranslate"><span class="pre">links</span></code> property of the event.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="change-events-api-client">
<h3>Change Events API Client<a class="headerlink" href="#change-events-api-client" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pdpyras.ChangeEventsAPISession">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pdpyras.</span></span><span class="sig-name descname"><span class="pre">ChangeEventsAPISession</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.ChangeEventsAPISession" title="Permalink to this definition">¶</a></dt>
<dd><p>Session class for submitting change events to the PagerDuty v2 Change Events API.</p>
<p>Implements methods for submitting change events to PagerDuty’s change events
API. See the <a class="reference external" href="https://developer.pagerduty.com/docs/events-api-v2/send-change-events/">Change Events API documentation</a>
for more details.</p>
<p>Inherits from <a class="reference internal" href="#pdpyras.PDSession" title="pdpyras.PDSession"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDSession</span></code></a>.</p>
<dl class="py property">
<dt class="sig sig-object py" id="pdpyras.ChangeEventsAPISession.auth_header">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">auth_header</span></span><a class="headerlink" href="#pdpyras.ChangeEventsAPISession.auth_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the header with the API credential used for authentication.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.ChangeEventsAPISession.prepare_headers">
<span class="sig-name descname"><span class="pre">prepare_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.ChangeEventsAPISession.prepare_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Add user agent and content type headers for Change Events API requests.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.ChangeEventsAPISession.send_change_event">
<span class="sig-name descname"><span class="pre">send_change_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">properties</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.ChangeEventsAPISession.send_change_event" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a change event to the v2 Change Events API.</p>
<p>See: <a class="reference external" href="https://developer.pagerduty.com/docs/events-api-v2/send-change-events/">https://developer.pagerduty.com/docs/events-api-v2/send-change-events/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**properties</strong> – Properties to set, i.e. <code class="docutils literal notranslate"><span class="pre">payload</span></code> and <code class="docutils literal notranslate"><span class="pre">links</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The response ID</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pdpyras.ChangeEventsAPISession.submit">
<span class="sig-name descname"><span class="pre">submit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">summary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_details</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">links</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.ChangeEventsAPISession.submit" title="Permalink to this definition">¶</a></dt>
<dd><p>Submit an incident change</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>summary</strong> (<em>str</em>) – Summary / brief description of the change.</p></li>
<li><p><strong>source</strong> (<em>str</em>) – A human-readable name identifying the source of the change.</p></li>
<li><p><strong>custom_details</strong> (<em>dict</em>) – The <code class="docutils literal notranslate"><span class="pre">payload.custom_details</span></code> property of the payload.</p></li>
<li><p><strong>links</strong> (<em>list</em>) – Set the <code class="docutils literal notranslate"><span class="pre">links</span></code> property of the event.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id6">
<h3>Errors<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pdpyras.PDClientError">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pdpyras.</span></span><span class="sig-name descname"><span class="pre">PDClientError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.PDClientError" title="Permalink to this definition">¶</a></dt>
<dd><p>General API errors base class.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pdpyras.PDClientError.response">
<span class="sig-name descname"><span class="pre">response</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pdpyras.PDClientError.response" title="Permalink to this definition">¶</a></dt>
<dd><p>The HTTP response object, if a response was successfully received.</p>
<p>In the case of network errors, this property will be None.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pdpyras.PDHTTPError">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pdpyras.</span></span><span class="sig-name descname"><span class="pre">PDHTTPError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.PDHTTPError" title="Permalink to this definition">¶</a></dt>
<dd><p>Error class representing errors strictly associated with HTTP responses.</p>
<p>This class was created to make it easier to more cleanly handle errors by
way of a class that is guaranteed to have its <code class="docutils literal notranslate"><span class="pre">response</span></code> be a valid
<a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object.</p>
<p>Whereas, the more generic <a class="reference internal" href="#pdpyras.PDClientError" title="pdpyras.PDClientError"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDClientError</span></code></a> could also be used
to denote such things as non-transient network errors wherein no response
was recevied from the API.</p>
<p>For instance, instead of this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">rget</span><span class="p">(</span><span class="s1">&#39;/users/PABC123&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">pdpyras</span><span class="o">.</span><span class="n">PDClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;HTTP error: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<p>one could write this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">rget</span><span class="p">(</span><span class="s1">&#39;/users/PABC123&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">pdpyras</span><span class="o">.</span><span class="n">PDHTTPErrror</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;HTTP error: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
<span class="k">except</span> <span class="n">pdpyras</span><span class="o">.</span><span class="n">PDClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pdpyras">
<span id="functions"></span><h3>Functions<a class="headerlink" href="#module-pdpyras" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pdpyras.auto_json">
<span class="sig-prename descclassname"><span class="pre">pdpyras.</span></span><span class="sig-name descname"><span class="pre">auto_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.auto_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Function decorator that makes methods return the full response JSON</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pdpyras.last_4">
<span class="sig-prename descclassname"><span class="pre">pdpyras.</span></span><span class="sig-name descname"><span class="pre">last_4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">secret</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.last_4" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an abbreviation of the input</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pdpyras.object_type">
<span class="sig-prename descclassname"><span class="pre">pdpyras.</span></span><span class="sig-name descname"><span class="pre">object_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.object_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Derives an object type (i.e. <code class="docutils literal notranslate"><span class="pre">user</span></code>) from a resource name (i.e. <code class="docutils literal notranslate"><span class="pre">users</span></code>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r_name</strong> – Resource name, i.e. would be <code class="docutils literal notranslate"><span class="pre">users</span></code> for the resource index URL
<code class="docutils literal notranslate"><span class="pre">https://api.pagerduty.com/users</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The object type name; usually the <code class="docutils literal notranslate"><span class="pre">type</span></code> property of an instance
of the given resource.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pdpyras.raise_on_error">
<span class="sig-prename descclassname"><span class="pre">pdpyras.</span></span><span class="sig-name descname"><span class="pre">raise_on_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.raise_on_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise an exception if a HTTP error response has error status.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> (<a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a>) – Response object corresponding to the response received.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The response object, if its status was success</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pdpyras.random">
<span class="sig-prename descclassname"><span class="pre">pdpyras.</span></span><span class="sig-name descname"><span class="pre">random</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">x</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">interval</span> <span class="pre">[0,</span> <span class="pre">1).</span></span></span><a class="headerlink" href="#pdpyras.random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pdpyras.resource_envelope">
<span class="sig-prename descclassname"><span class="pre">pdpyras.</span></span><span class="sig-name descname"><span class="pre">resource_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.resource_envelope" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience and consistency decorator for HTTP verb functions.</p>
<p>This makes the request methods <code class="docutils literal notranslate"><span class="pre">GET</span></code>, <code class="docutils literal notranslate"><span class="pre">POST</span></code> and <code class="docutils literal notranslate"><span class="pre">PUT</span></code> always return a
dictionary object representing the resource at the envelope property (i.e.
the <code class="docutils literal notranslate"><span class="pre">{...}</span></code> from <code class="docutils literal notranslate"><span class="pre">{&quot;escalation_policy&quot;:{...}}</span></code> in a get/put request to
an escalation policy)  rather than a <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object.</p>
<p>Methods using this decorator will raise a <a class="reference internal" href="#pdpyras.PDClientError" title="pdpyras.PDClientError"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDClientError</span></code></a> with its
<code class="docutils literal notranslate"><span class="pre">response</span></code> property being being the <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object in the
case of any error (as of version 4.2 this is subclassed as
<a class="reference internal" href="#pdpyras.PDHTTPError" title="pdpyras.PDHTTPError"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDHTTPError</span></code></a>), so that the implementer can access it by catching the
exception, and thus design their own custom logic around different types of
error responses.</p>
<p>It allows creation of methods that can provide more succinct ways of making
API calls. In particular, the methods using this decorator don’t require
checking for a success status, JSON-decoding the response body and then
pulling the essential data out of the envelope (i.e. for <code class="docutils literal notranslate"><span class="pre">GET</span>
<span class="pre">/escalation_policies/{id}</span></code> one would have to access the
<code class="docutils literal notranslate"><span class="pre">escalation_policy</span></code> property of the object decoded from the response body,
assuming nothing went wrong in the whole process).</p>
<p>These methods are <a class="reference internal" href="#pdpyras.APISession.rget" title="pdpyras.APISession.rget"><code class="xref py py-attr docutils literal notranslate"><span class="pre">APISession.rget</span></code></a>, <a class="reference internal" href="#pdpyras.APISession.rpost" title="pdpyras.APISession.rpost"><code class="xref py py-attr docutils literal notranslate"><span class="pre">APISession.rpost</span></code></a> and
<a class="reference internal" href="#pdpyras.APISession.rput" title="pdpyras.APISession.rput"><code class="xref py py-attr docutils literal notranslate"><span class="pre">APISession.rput</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>method</strong> – Method being decorated. Must take one positional argument
after <code class="docutils literal notranslate"><span class="pre">self</span></code> that is the URL/path to the resource, and must return an
object of class <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a>, and be named after the HTTP method
but with “r” prepended.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable object; the reformed method</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pdpyras.resource_name">
<span class="sig-prename descclassname"><span class="pre">pdpyras.</span></span><span class="sig-name descname"><span class="pre">resource_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.resource_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms an object type into a resource name</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_type</strong> – The object type, i.e. <code class="docutils literal notranslate"><span class="pre">user</span></code> or <code class="docutils literal notranslate"><span class="pre">user_reference</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The name of the resource, i.e. the last part of the URL for the
resource’s index URL</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pdpyras.resource_path">
<span class="sig-prename descclassname"><span class="pre">pdpyras.</span></span><span class="sig-name descname"><span class="pre">resource_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.resource_path" title="Permalink to this definition">¶</a></dt>
<dd><p>API call decorator that allows passing a resource dict as the path/URL</p>
<p>Most resources returned by the API will contain a <code class="docutils literal notranslate"><span class="pre">self</span></code> attribute that is
the URL of the resource itself.</p>
<p>Using this decorator allows the implementer to pass either a URL/path or
such a resource dictionary as the <code class="docutils literal notranslate"><span class="pre">path</span></code> argument, thus eliminating the
need to re-construct the resource URL or hold it in a temporary variable.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pdpyras.tokenize_url_path">
<span class="sig-prename descclassname"><span class="pre">pdpyras.</span></span><span class="sig-name descname"><span class="pre">tokenize_url_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseurl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'https://api.pagerduty.com'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.tokenize_url_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Classifies a URL according to some global patterns in the API.</p>
<p>If the URL is to access a specific individual resource by ID, the node type
will be identified as <code class="docutils literal notranslate"><span class="pre">{id}</span></code>, whereas if it is an index, it will be
identified as <code class="docutils literal notranslate"><span class="pre">{index}</span></code>.</p>
<p>For instance, <code class="docutils literal notranslate"><span class="pre">https://api.pagerduty.com/users</span></code> would be classified as
<code class="docutils literal notranslate"><span class="pre">(&quot;users&quot;,</span> <span class="pre">&quot;{index}&quot;)</span></code>, and <code class="docutils literal notranslate"><span class="pre">https://api.pagerduty.com/users/PABC123</span></code>
would be classified as <code class="docutils literal notranslate"><span class="pre">(&quot;users&quot;,</span> <span class="pre">&quot;{id}&quot;)</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>) – The URL (or path) to be classified; the function should accept either</p></li>
<li><p><strong>baseurl</strong> (<em>str</em>) – API base URL</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pdpyras.try_decoding">
<span class="sig-prename descclassname"><span class="pre">pdpyras.</span></span><span class="sig-name descname"><span class="pre">try_decoding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.try_decoding" title="Permalink to this definition">¶</a></dt>
<dd><p>JSON-decode a response body and raise <a class="reference internal" href="#pdpyras.PDClientError" title="pdpyras.PDClientError"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDClientError</span></code></a> if it fails.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> – <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="id7">
<h2>Changelog<a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h2>
<p><strong>2022-10-13: Version 4.5.1</strong></p>
<ul class="simple">
<li><p>The default value for request timeouts is now 60s.</p></li>
<li><p>Method <code class="docutils literal notranslate"><span class="pre">api_key_access</span></code> is now implemented as <a class="reference internal" href="#pdpyras.APISession.api_key_access" title="pdpyras.APISession.api_key_access"><code class="xref py py-attr docutils literal notranslate"><span class="pre">APISession.api_key_access</span></code></a>; formerly it was implemented in the parent class and inherited in classes that did not need it and could not use it.</p></li>
</ul>
<p><strong>2022-02-22: Version 4.5.0</strong></p>
<ul class="simple">
<li><p>Add a new API generator <code class="docutils literal notranslate"><span class="pre">iter_cursor</span></code> to <a class="reference internal" href="#pdpyras.APISession" title="pdpyras.APISession"><code class="xref py py-class docutils literal notranslate"><span class="pre">APISession</span></code></a> that yields results from API endpoints that support cursor-based pagination, requesting the next page of results whenever needed.</p></li>
</ul>
<p><strong>2022-01-18: Version 4.4.0</strong></p>
<ul class="simple">
<li><p>Added new error class <a class="reference internal" href="#pdpyras.PDHTTPError" title="pdpyras.PDHTTPError"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDHTTPError</span></code></a> for strictly application-level errors (i.e. HTTP responses vs. network errors), inherits from <a class="reference internal" href="#pdpyras.PDClientError" title="pdpyras.PDClientError"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDClientError</span></code></a></p></li>
<li><p>Removed unnecessary dependencies that were hold-outs from Python 2.7 compatibility (deprecated)</p></li>
<li><p>Automatically add square brackets to query parameters that are of list type if the user forgets to do so, per the requirement of using <a class="reference external" href="https://developer.pagerduty.com/docs/ZG9jOjExMDI5NTU2-filtering#set-filters">set filters</a></p></li>
<li><p>Fix bug: the <a class="reference internal" href="#pdpyras.PDSession.stagger_cooldown" title="pdpyras.PDSession.stagger_cooldown"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PDSession.stagger_cooldown</span></code></a> feature added in version 3.2 only applied to network error/retry; it now applies to all forms of retrial</p></li>
<li><p>Add “update” keyword argument to <a class="reference internal" href="#pdpyras.APISession.persist" title="pdpyras.APISession.persist"><code class="xref py py-attr docutils literal notranslate"><span class="pre">APISession.persist</span></code></a> that updates any existing resource with the provided values</p></li>
</ul>
<p><strong>2021-06-28: Version 4.3.0</strong></p>
<ul class="simple">
<li><p>Make timeout configurable per-session as an instance variable (based on <a class="reference external" href="https://github.com/PagerDuty/pdpyras/pull/48#discussion_r529711040">a suggestion in pull #48</a> made by &#64;badnetmask)</p></li>
<li><p>Drop support for Python 2.7</p></li>
<li><p>Improve code samples formatting improvement (&#64;jackton1 / <a class="reference external" href="https://github.com/PagerDuty/pdpyras/pull/65">#65</a>)</p></li>
<li><p>Replace deprecated escape sequence for the double-splat operator in docstrings (&#64;ashwin153 / <a class="reference external" href="https://github.com/PagerDuty/pdpyras/pull/68">#68</a>)</p></li>
</ul>
<p><strong>2021-05-13: Version 4.2.1</strong></p>
<ul class="simple">
<li><p>Implement work-around for issue in response plays API (issue <a class="reference external" href="https://github.com/PagerDuty/pdpyras/issues/61">#61</a>)</p></li>
</ul>
<p><strong>2021-05-04: Version 4.2.0</strong></p>
<ul class="simple">
<li><p>Add new change events API client class (&#64;hunner / <a class="reference external" href="https://github.com/PagerDuty/pdpyras/pull/56">#56</a>)</p></li>
</ul>
<p><strong>2021-03-18: Version 4.1.4</strong></p>
<ul class="simple">
<li><dl class="simple">
<dt>Fix regression in <a class="reference internal" href="#pdpyras.EventsAPISession.post" title="pdpyras.EventsAPISession.post"><code class="xref py py-attr docutils literal notranslate"><span class="pre">EventsAPISession.post</span></code></a></dt><dd><ul>
<li><p>Use case: explicitly-defined body (<code class="docutils literal notranslate"><span class="pre">json</span></code> keyword argument) without a <code class="docutils literal notranslate"><span class="pre">routing_key</span></code> parameter</p></li>
<li><p>This was previously possible (before version 4.1.3) with the <code class="docutils literal notranslate"><span class="pre">X-Routing-Key</span></code> header (an undocumented API feature)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p><strong>2021-03-10: Version 4.1.3</strong></p>
<ul class="simple">
<li><p>Use documented method for including the routing key in the request for API V2 (addresses <a class="reference external" href="https://github.com/PagerDuty/pdpyras/issues/53">#53</a>)</p></li>
<li><p>Add warning for Python 2.7</p></li>
<li><p>Configurable timeout: argument to <a class="reference external" href="https://docs.python-requests.org/en/master/api/#requests.Session.request">requests.Session.request</a> set in default args to backwards-compatible 5 second value that can be set at the module level (&#64;ctrlaltdel / <cite>#48 &lt;https://github.com/PagerDuty/pdpyras/pull/48&gt;</cite>)</p></li>
</ul>
<p><strong>2020-09-15: Version 4.1.2</strong></p>
<ul class="simple">
<li><dl class="simple">
<dt>Address issue #37 and add other enhancements to <code class="docutils literal notranslate"><span class="pre">iter_all</span></code>:</dt><dd><ul>
<li><p>Stop iteration in <code class="docutils literal notranslate"><span class="pre">iter_all</span></code> if the iteration limit (10000) is encountered, versus erroring out (because exceeding it will elicit a 400 response)</p></li>
<li><p>Add the ability to set an initial offset via <code class="docutils literal notranslate"><span class="pre">params</span></code> versus always starting from <code class="docutils literal notranslate"><span class="pre">offset=0</span></code> in <code class="docutils literal notranslate"><span class="pre">iter_all</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Capitalize “constants”</p></li>
</ul>
<p><strong>2020-06-26: Version 4.1.1</strong></p>
<ul class="simple">
<li><p>Define class variable <code class="docutils literal notranslate"><span class="pre">retry</span></code> initially as <code class="docutils literal notranslate"><span class="pre">{}</span></code> instead of <code class="docutils literal notranslate"><span class="pre">None</span></code> (<a class="reference external" href="https://github.com/PagerDuty/pdpyras/issues/32">#32</a>)</p></li>
</ul>
<p><strong>2020-03-08: Version: 4.1</strong></p>
<ul class="simple">
<li><p>Added new idempotent resource creator function, <a class="reference internal" href="#pdpyras.APISession.persist" title="pdpyras.APISession.persist"><code class="xref py py-attr docutils literal notranslate"><span class="pre">APISession.persist</span></code></a></p></li>
<li><p>Added the ability to use resource dictionaries (that have a <code class="docutils literal notranslate"><span class="pre">self</span></code> attribute) in place of URLs.</p></li>
</ul>
<p><strong>2020-02-04: Version 4.0</strong></p>
<ul class="simple">
<li><p>Added support for using OAuth 2 access tokens to authenticate (<a class="reference external" href="https://github.com/PagerDuty/pdpyras/issues/23">#23</a>)</p></li>
<li><p>Added a property that indicates the access level/scope of a given API credential (<a class="reference external" href="https://github.com/PagerDuty/pdpyras/issues/22">#22</a>)</p></li>
</ul>
<p><strong>2020-01-10: version 3.2.1</strong></p>
<ul class="simple">
<li><p>Fixed bug in <a class="reference internal" href="#pdpyras.APISession.trunc_token" title="pdpyras.APISession.trunc_token"><code class="xref py py-attr docutils literal notranslate"><span class="pre">APISession.trunc_token</span></code></a>; property name typo causes <code class="docutils literal notranslate"><span class="pre">AttributeError</span></code></p></li>
</ul>
<p><strong>2019-10-31: version 3.2</strong></p>
<ul class="simple">
<li><p>The page size (<code class="docutils literal notranslate"><span class="pre">limit</span></code>) parameter can now be set on a per-call basis in any of the <code class="docutils literal notranslate"><span class="pre">*_all</span></code> methods (i.e. <code class="xref py py-attr docutils literal notranslate"><span class="pre">PDSession.iter_all</span></code>) by passing the <code class="docutils literal notranslate"><span class="pre">page_size</span></code> keyword argument. If the argument is not present, the default page size will be used.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">X-Request-Id</span></code> header in responses is now captured in log messages to make it easier to identify API calls when communicating with PagerDuty Support</p></li>
<li><p>Extended API call metadata is also now logged.</p></li>
<li><p>The cooldown time between rate limit responses can optionally be randomized by setting <a class="reference internal" href="#pdpyras.PDSession.stagger_cooldown" title="pdpyras.PDSession.stagger_cooldown"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PDSession.stagger_cooldown</span></code></a> to a positive number.</p></li>
</ul>
<p><strong>2019-10-01: version 3.1.2</strong></p>
<ul class="simple">
<li><p>Fixed regression bug / departure from documentation (#17): the <code class="docutils literal notranslate"><span class="pre">payload</span></code> parameter does not merge with but rather completely replaces the default payload</p></li>
</ul>
<p><strong>2019-04-05: version 3.1.1</strong></p>
<ul class="simple">
<li><dl class="simple">
<dt>Changed behavior of HTTP retry that caused issues with some internal tools: raising <code class="docutils literal notranslate"><span class="pre">PDClientError</span></code> in the event of non-transient HTTP error, in the <code class="docutils literal notranslate"><span class="pre">request</span></code> method, versus returning the request object and logging it. The previous behavior was:</dt><dd><ul>
<li><p>Not the intended design</p></li>
<li><p>At odds with the documentated behavior</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p><strong>2019-04-05: version 3.1:</strong></p>
<ul class="simple">
<li><p>Introduction of a custom <code class="docutils literal notranslate"><span class="pre">User-Agent</span></code> header to distinguish the API client as such, for the purposes of usage analytics</p></li>
</ul>
<p><strong>2019-04-02: version 3.0.2:</strong></p>
<p>Important bug fixes to the custom HTTP retry logic:</p>
<ul class="simple">
<li><p>Fixed <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> in <code class="docutils literal notranslate"><span class="pre">APISession.request</span></code></p></li>
<li><p>Fixed incorrect behavior (retrying more than the specified amount of times) due to faulty comparison logic</p></li>
</ul>
<p><strong>2019-03-14: version 3.0.1:</strong></p>
<p>A light Events API client methods refactor:</p>
<ul class="simple">
<li><p>All keyword arguments specific to sending trigger events have been refactored out of the generic <code class="docutils literal notranslate"><span class="pre">EventsAPISession.send_event</span></code> method</p></li>
<li><p>Now, instead, <code class="docutils literal notranslate"><span class="pre">send_event</span></code> and uses a catch-all keyword argument to set event properties.</p></li>
<li><p>The keyword arguments specific to triggering incidents are in the method EventsAPISession.trigger method.</p></li>
</ul>
<p><strong>2019-03-12: version 3.0:</strong></p>
<ul class="simple">
<li><p>Added new Events API session class that still has most of the same functional features as the REST API session class.</p></li>
</ul>
<p><strong>2019-01-28: version 2.4.1:</strong></p>
<ul class="simple">
<li><p>Fixed bug: unpacking wrapped entities does not work with <code class="docutils literal notranslate"><span class="pre">/log_entries</span></code></p></li>
</ul>
<p><strong>2019-01-10: version 2.4:</strong></p>
<ul class="simple">
<li><p>Whitelisting of endpoints supported by the <code class="docutils literal notranslate"><span class="pre">r*</span></code> / <code class="docutils literal notranslate"><span class="pre">*_all</span></code> methods has been rescinded, and documentation has been updated with how to identify endpoints that these methods can be used with.</p></li>
</ul>
<p><strong>2019-01-03: version 2.3:</strong></p>
<ul class="simple">
<li><p>More helpful error messaging when using <code class="docutils literal notranslate"><span class="pre">r*</span></code> / <code class="docutils literal notranslate"><span class="pre">*_all</span></code> methods on endpoints they don’t support</p></li>
<li><p>Resource envelope auto-unpacking no longer validates for the presence of a <code class="docutils literal notranslate"><span class="pre">type</span></code> property in order to support posting to business impact metrics</p></li>
</ul>
<p><strong>2018-12-04: version 2.2:</strong></p>
<ul class="simple">
<li><p>Methods <code class="docutils literal notranslate"><span class="pre">list_all</span></code> and <code class="docutils literal notranslate"><span class="pre">dict_all</span></code> turn all results from an index into a list/dict to save a bit of effort</p></li>
</ul>
<p><strong>2018-11-28: version 2.1:</strong></p>
<ul class="simple">
<li><p>Support for performing multi-update actions (i.e. <em>Manage Incidents</em>) via the <code class="docutils literal notranslate"><span class="pre">rput</span></code> method.</p></li>
<li><p>The default behavior of <code class="docutils literal notranslate"><span class="pre">iter_all</span></code> is now to raise an exception if an error response is received from the API during iteration.</p></li>
</ul>
<p><strong>Changelog Started 2018-11-28</strong></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="#">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">PDPYRAS: PagerDuty Python REST API Sessions</a><ul>
<li><a class="reference internal" href="#about">About</a><ul>
<li><a class="reference internal" href="#features">Features</a></li>
<li><a class="reference internal" href="#history">History</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
<li><a class="reference internal" href="#warranty">Warranty</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#usage-guide">Usage Guide</a><ul>
<li><a class="reference internal" href="#authentication">Authentication</a><ul>
<li><a class="reference internal" href="#using-a-basic-rest-api-key">Using a basic REST API key</a></li>
<li><a class="reference internal" href="#using-an-oauth2-token">Using an OAuth2 token</a></li>
</ul>
</li>
<li><a class="reference internal" href="#basic-usage">Basic usage</a></li>
<li><a class="reference internal" href="#general-concepts">General concepts</a><ul>
<li><a class="reference internal" href="#urls">URLs</a></li>
<li><a class="reference internal" href="#request-and-response-bodies">Request and response bodies</a></li>
<li><a class="reference internal" href="#resource-schemas">Resource schemas</a></li>
<li><a class="reference internal" href="#data-types">Data types</a></li>
<li><a class="reference internal" href="#using-http-client-library-features">Using HTTP client library features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#wrapped-entities">Wrapped entities</a><ul>
<li><a class="reference internal" href="#functions-that-assume-entity-wrapping">Functions that assume entity wrapping</a></li>
<li><a class="reference internal" href="#supported-endpoints">Supported endpoints</a></li>
<li><a class="reference internal" href="#list-of-non-conformal-endpoints">List of non-conformal endpoints</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pagination">Pagination</a><ul>
<li><a class="reference internal" href="#performance">Performance</a></li>
<li><a class="reference internal" href="#updating-creating-or-deleting-while-paginating">Updating, creating or deleting while paginating</a></li>
</ul>
</li>
<li><a class="reference internal" href="#multi-updating">Multi-updating</a></li>
<li><a class="reference internal" href="#error-handling">Error handling</a></li>
<li><a class="reference internal" href="#http-retry-logic">HTTP retry logic</a><ul>
<li><a class="reference internal" href="#cooldown">Cooldown</a></li>
<li><a class="reference internal" href="#rate-limiting">Rate Limiting</a></li>
<li><a class="reference internal" href="#http-retry-configuration">HTTP retry configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#events-api">Events API</a></li>
<li><a class="reference internal" href="#change-events-api">Change Events API</a></li>
</ul>
</li>
<li><a class="reference internal" href="#contributing">Contributing</a></li>
<li><a class="reference internal" href="#releasing">Releasing</a><ul>
<li><a class="reference internal" href="#initial-setup">Initial Setup</a></li>
<li><a class="reference internal" href="#before-publishing">Before publishing</a><ul>
<li><a class="reference internal" href="#perform-end-to-end-publish-and-installation-testing">Perform end-to-end publish and installation testing</a></li>
<li><a class="reference internal" href="#merge-changes-and-tag">Merge changes and tag</a></li>
</ul>
</li>
<li><a class="reference internal" href="#publishing-a-new-version">Publishing a new version</a></li>
</ul>
</li>
<li><a class="reference internal" href="#developer-interface">Developer Interface</a><ul>
<li><a class="reference internal" href="#generic-api-client">Generic API Client</a><ul>
<li><a class="reference internal" href="#pdpyras.PDSession"><code class="docutils literal notranslate"><span class="pre">PDSession</span></code></a><ul>
<li><a class="reference internal" href="#pdpyras.PDSession.after_set_api_key"><code class="docutils literal notranslate"><span class="pre">PDSession.after_set_api_key()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.api_key"><code class="docutils literal notranslate"><span class="pre">PDSession.api_key</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.auth_header"><code class="docutils literal notranslate"><span class="pre">PDSession.auth_header</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.log"><code class="docutils literal notranslate"><span class="pre">PDSession.log</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.max_http_attempts"><code class="docutils literal notranslate"><span class="pre">PDSession.max_http_attempts</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.max_network_attempts"><code class="docutils literal notranslate"><span class="pre">PDSession.max_network_attempts</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.normalize_params"><code class="docutils literal notranslate"><span class="pre">PDSession.normalize_params()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.normalize_url"><code class="docutils literal notranslate"><span class="pre">PDSession.normalize_url()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.parent"><code class="docutils literal notranslate"><span class="pre">PDSession.parent</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.postprocess"><code class="docutils literal notranslate"><span class="pre">PDSession.postprocess()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.prepare_headers"><code class="docutils literal notranslate"><span class="pre">PDSession.prepare_headers()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.raise_if_http_error"><code class="docutils literal notranslate"><span class="pre">PDSession.raise_if_http_error</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.request"><code class="docutils literal notranslate"><span class="pre">PDSession.request()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.retry"><code class="docutils literal notranslate"><span class="pre">PDSession.retry</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.set_api_key"><code class="docutils literal notranslate"><span class="pre">PDSession.set_api_key()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.sleep_timer"><code class="docutils literal notranslate"><span class="pre">PDSession.sleep_timer</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.sleep_timer_base"><code class="docutils literal notranslate"><span class="pre">PDSession.sleep_timer_base</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.stagger_cooldown"><code class="docutils literal notranslate"><span class="pre">PDSession.stagger_cooldown</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.timeout"><code class="docutils literal notranslate"><span class="pre">PDSession.timeout</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.PDSession.trunc_key"><code class="docutils literal notranslate"><span class="pre">PDSession.trunc_key</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#rest-api-client">REST API Client</a><ul>
<li><a class="reference internal" href="#pdpyras.APISession"><code class="docutils literal notranslate"><span class="pre">APISession</span></code></a><ul>
<li><a class="reference internal" href="#pdpyras.APISession.rdelete"><code class="docutils literal notranslate"><span class="pre">APISession.rdelete()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.rget"><code class="docutils literal notranslate"><span class="pre">APISession.rget()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.rpost"><code class="docutils literal notranslate"><span class="pre">APISession.rpost()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.rput"><code class="docutils literal notranslate"><span class="pre">APISession.rput()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.after_set_api_key"><code class="docutils literal notranslate"><span class="pre">APISession.after_set_api_key()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.api_call_counts"><code class="docutils literal notranslate"><span class="pre">APISession.api_call_counts</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.api_key_access"><code class="docutils literal notranslate"><span class="pre">APISession.api_key_access</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.api_time"><code class="docutils literal notranslate"><span class="pre">APISession.api_time</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.auth_header"><code class="docutils literal notranslate"><span class="pre">APISession.auth_header</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.auth_type"><code class="docutils literal notranslate"><span class="pre">APISession.auth_type</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.default_from"><code class="docutils literal notranslate"><span class="pre">APISession.default_from</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.default_page_size"><code class="docutils literal notranslate"><span class="pre">APISession.default_page_size</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.dict_all"><code class="docutils literal notranslate"><span class="pre">APISession.dict_all()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.find"><code class="docutils literal notranslate"><span class="pre">APISession.find()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.iter_all"><code class="docutils literal notranslate"><span class="pre">APISession.iter_all()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.iter_cursor"><code class="docutils literal notranslate"><span class="pre">APISession.iter_cursor()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.list_all"><code class="docutils literal notranslate"><span class="pre">APISession.list_all()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.persist"><code class="docutils literal notranslate"><span class="pre">APISession.persist()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.postprocess"><code class="docutils literal notranslate"><span class="pre">APISession.postprocess()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.prepare_headers"><code class="docutils literal notranslate"><span class="pre">APISession.prepare_headers()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.profiler_key"><code class="docutils literal notranslate"><span class="pre">APISession.profiler_key()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.subdomain"><code class="docutils literal notranslate"><span class="pre">APISession.subdomain</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.total_call_count"><code class="docutils literal notranslate"><span class="pre">APISession.total_call_count</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.total_call_time"><code class="docutils literal notranslate"><span class="pre">APISession.total_call_time</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.trunc_token"><code class="docutils literal notranslate"><span class="pre">APISession.trunc_token</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.APISession.url"><code class="docutils literal notranslate"><span class="pre">APISession.url</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#events-api-client">Events API Client</a><ul>
<li><a class="reference internal" href="#pdpyras.EventsAPISession"><code class="docutils literal notranslate"><span class="pre">EventsAPISession</span></code></a><ul>
<li><a class="reference internal" href="#pdpyras.EventsAPISession.acknowledge"><code class="docutils literal notranslate"><span class="pre">EventsAPISession.acknowledge()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.EventsAPISession.auth_header"><code class="docutils literal notranslate"><span class="pre">EventsAPISession.auth_header</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.EventsAPISession.post"><code class="docutils literal notranslate"><span class="pre">EventsAPISession.post()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.EventsAPISession.prepare_headers"><code class="docutils literal notranslate"><span class="pre">EventsAPISession.prepare_headers()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.EventsAPISession.resolve"><code class="docutils literal notranslate"><span class="pre">EventsAPISession.resolve()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.EventsAPISession.send_event"><code class="docutils literal notranslate"><span class="pre">EventsAPISession.send_event()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.EventsAPISession.trigger"><code class="docutils literal notranslate"><span class="pre">EventsAPISession.trigger()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#change-events-api-client">Change Events API Client</a><ul>
<li><a class="reference internal" href="#pdpyras.ChangeEventsAPISession"><code class="docutils literal notranslate"><span class="pre">ChangeEventsAPISession</span></code></a><ul>
<li><a class="reference internal" href="#pdpyras.ChangeEventsAPISession.auth_header"><code class="docutils literal notranslate"><span class="pre">ChangeEventsAPISession.auth_header</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.ChangeEventsAPISession.prepare_headers"><code class="docutils literal notranslate"><span class="pre">ChangeEventsAPISession.prepare_headers()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.ChangeEventsAPISession.send_change_event"><code class="docutils literal notranslate"><span class="pre">ChangeEventsAPISession.send_change_event()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.ChangeEventsAPISession.submit"><code class="docutils literal notranslate"><span class="pre">ChangeEventsAPISession.submit()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id6">Errors</a><ul>
<li><a class="reference internal" href="#pdpyras.PDClientError"><code class="docutils literal notranslate"><span class="pre">PDClientError</span></code></a><ul>
<li><a class="reference internal" href="#pdpyras.PDClientError.response"><code class="docutils literal notranslate"><span class="pre">PDClientError.response</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pdpyras.PDHTTPError"><code class="docutils literal notranslate"><span class="pre">PDHTTPError</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pdpyras">Functions</a><ul>
<li><a class="reference internal" href="#pdpyras.auto_json"><code class="docutils literal notranslate"><span class="pre">auto_json()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.last_4"><code class="docutils literal notranslate"><span class="pre">last_4()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.object_type"><code class="docutils literal notranslate"><span class="pre">object_type()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.raise_on_error"><code class="docutils literal notranslate"><span class="pre">raise_on_error()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.random"><code class="docutils literal notranslate"><span class="pre">random()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.resource_envelope"><code class="docutils literal notranslate"><span class="pre">resource_envelope()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.resource_name"><code class="docutils literal notranslate"><span class="pre">resource_name()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.resource_path"><code class="docutils literal notranslate"><span class="pre">resource_path()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.tokenize_url_path"><code class="docutils literal notranslate"><span class="pre">tokenize_url_path()</span></code></a></li>
<li><a class="reference internal" href="#pdpyras.try_decoding"><code class="docutils literal notranslate"><span class="pre">try_decoding()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id7">Changelog</a></li>
</ul>
</li>
</ul>

  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, PagerDuty Inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.2.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>