
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>PDPYRAS: PagerDuty Python REST API Sessions &#8212; PagerDuty Python REST API Sessions 2.2.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="pdpyras-pagerduty-python-rest-api-sessions">
<h1>PDPYRAS: PagerDuty Python REST API Sessions<a class="headerlink" href="#pdpyras-pagerduty-python-rest-api-sessions" title="Permalink to this headline">¶</a></h1>
<p>A minimal, practical Python client for the PagerDuty REST API.</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/PagerDuty/pdpyras">GitHub repository</a></li>
<li><a class="reference external" href="https://pagerduty.github.io/pdpyras">Documentation</a></li>
</ul>
<div class="section" id="about">
<h2>About<a class="headerlink" href="#about" title="Permalink to this headline">¶</a></h2>
<p>This library supplies a class <a class="reference internal" href="#pdpyras.APISession" title="pdpyras.APISession"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdpyras.APISession</span></code></a> extending
<a class="reference external" href="http://docs.python-requests.org/en/master/api/#request-sessions">requests.Session</a> from the <a class="reference external" href="http://docs.python-requests.org/en/master/">Requests</a> HTTP library. It serves as a practical
and simple-as-possible-but-no-simpler abstraction layer for accessing the
PagerDuty REST API, differing minimally from the already well-known and
well-documented underlying HTTP library. This makes it appropriate for use as
the foundation of anything from a feature-rich REST API client library to a
quick-and-dirty API script.</p>
<p>This module was borne of necessity for a basic, reusable API client to
eliminate code duplication in some of PagerDuty Support’s internal Python-based
API tools, and to get the job done without reinventing the wheel or getting in
the way. We also frequently found ourselves performing REST API requests using
beta or non-documented API endpoints for one reason or another, so we also
needed a client that provided easy access to features of the underlying HTTP
library, but that eliminated tedious tasks like querying, <a class="reference external" href="https://v2.developer.pagerduty.com/docs/pagination">pagination</a> and
header-setting. Finally, we discovered that the way we were using <a class="reference external" href="http://docs.python-requests.org/en/master/">requests</a>
wasn’t making use of connection re-use, and wanted a way to easily enforce this
as a standard practice.</p>
<p>Ultimately, we deemed most other libraries to be both overkill for this task
and also not very conducive to use for experimental API calls.</p>
<div class="section" id="features">
<h3>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Efficient API access through automatic HTTP connection pooling and
persistence</li>
<li>Tested in / support for Python 2.7 through 3.7</li>
<li>Automatic cooldown/reattempt for rate limiting and transient network problems</li>
<li>Inclusion of required <a class="reference external" href="https://v2.developer.pagerduty.com/docs/rest-api#http-request-headers">HTTP Request Headers</a> for PagerDuty REST API requests</li>
<li>Bulk data retrieval and iteration over <a class="reference external" href="https://v2.developer.pagerduty.com/docs/endpoints#resources-index">resource index</a> endpoints with
automatic pagination</li>
<li>Individual object retrieval by name</li>
<li>API request profiling</li>
</ul>
</div>
<div class="section" id="copyright">
<h3>Copyright<a class="headerlink" href="#copyright" title="Permalink to this headline">¶</a></h3>
<p>All the code in this distribution is Copyright (c) 2018 PagerDuty.</p>
<p><code class="docutils literal notranslate"><span class="pre">pdpyras</span></code> is made available under the MIT License:</p>
<blockquote>
<div><p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the “Software”), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.</p>
</div></blockquote>
</div>
<div class="section" id="warranty">
<h3>Warranty<a class="headerlink" href="#warranty" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.</div></blockquote>
</div>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>If <code class="docutils literal notranslate"><span class="pre">pip</span></code> is available, it can be installed via:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pdpyras</span>
</pre></div>
</div>
<p>Alternately, if <a class="reference external" href="http://docs.python-requests.org/en/master/">requests</a> has already been installed locally, and <code class="docutils literal notranslate"><span class="pre">urllib3</span></code>
is available, one can simply download <a class="reference external" href="https://raw.githubusercontent.com/PagerDuty/pdpyras/master/pdpyras.py">pdpyras.py</a> into the directory where it
will be used.</p>
</div>
<div class="section" id="usage-guide">
<h2>Usage Guide<a class="headerlink" href="#usage-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="basic-usage">
<h3>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h3>
<p>Some examples of usage:</p>
<p><strong>Basic getting:</strong> Obtain a user profile as a dict object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pdpyras</span> <span class="k">import</span> <span class="n">APISession</span>
<span class="n">api_token</span> <span class="o">=</span> <span class="s1">&#39;your-token-here&#39;</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">APISession</span><span class="p">(</span><span class="n">api_token</span><span class="p">)</span>

<span class="c1"># Using requests.Session.get:</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/users/PABC123&#39;</span><span class="p">)</span>
<span class="n">user</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span>

<span class="c1"># Or, more succinctly:</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">rget</span><span class="p">(</span><span class="s1">&#39;/users/PABC123&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Iteration (1):</strong> Iterate over all users and print their ID, email and name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pdpyras</span> <span class="k">import</span> <span class="n">APISession</span>
<span class="n">api_token</span> <span class="o">=</span> <span class="s1">&#39;your-token-here&#39;</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">APISession</span><span class="p">(</span><span class="n">api_token</span><span class="p">)</span>
<span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">session</span><span class="o">.</span><span class="n">iter_all</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">],</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p><strong>Iteration (2):</strong> Compile a list of all servies with “SN” in their name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pdpyras</span> <span class="k">import</span> <span class="n">APISession</span>
<span class="n">api_token</span> <span class="o">=</span> <span class="s1">&#39;your-token-here&#39;</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">APISession</span><span class="p">(</span><span class="n">api_token</span><span class="p">)</span>
<span class="n">services</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">iter_all</span><span class="p">(</span><span class="s1">&#39;services&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="s1">&#39;SN&#39;</span><span class="p">}))</span>
</pre></div>
</div>
<p><strong>Querying and updating:</strong> Find a user exactly matching email address <code class="docutils literal notranslate"><span class="pre">jane&#64;example35.com</span></code>
and update their name to “Jane Doe”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pdpyras</span> <span class="k">import</span> <span class="n">APISession</span>
<span class="n">api_token</span> <span class="o">=</span> <span class="s1">&#39;your-token-here&#39;</span>
<span class="n">sesion</span> <span class="o">=</span> <span class="n">APISession</span><span class="p">(</span><span class="n">api_token</span><span class="p">)</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;jane@example35.com&#39;</span><span class="p">,</span> <span class="n">attribute</span><span class="o">=</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Update using put directly:</span>
    <span class="n">updated_user</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;self&#39;</span><span class="p">],</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;user&#39;</span><span class="p">:{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Jane Doe&#39;</span><span class="p">}</span>
    <span class="p">})</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
        <span class="n">updated_user</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span>

    <span class="c1"># Alternately / more succinctly:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">updated_user</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">rput</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;self&#39;</span><span class="p">],</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Jane Doe&#39;</span>
        <span class="p">})</span>
    <span class="k">except</span> <span class="n">PDClientError</span><span class="p">:</span>
        <span class="n">updated_user</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
<p><strong>Multiple update:</strong> acknowledge all triggered incidents assigned to user with
ID <code class="docutils literal notranslate"><span class="pre">PHIJ789</span></code>. Note that to acknowledge, we need to set the <code class="docutils literal notranslate"><span class="pre">From</span></code> header.
This example assumes that <code class="docutils literal notranslate"><span class="pre">admin&#64;example.com</span></code> corresponds to a user in the
PagerDuty account:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pdpyras</span> <span class="k">import</span> <span class="n">APISession</span>
<span class="n">api_token</span> <span class="o">=</span> <span class="s1">&#39;your-token-here&#39;</span>
<span class="n">sesion</span> <span class="o">=</span> <span class="n">APISession</span><span class="p">(</span><span class="n">api_token</span><span class="p">,</span> <span class="n">default_from</span><span class="o">=</span><span class="s1">&#39;admin@example.com&#39;</span><span class="p">)</span>
<span class="c1"># Query incidents</span>
<span class="n">incidents</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">iter_all</span><span class="p">(</span>
    <span class="s1">&#39;incidents&#39;</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;user_ids[]&#39;</span><span class="p">:[</span><span class="s1">&#39;PHIJ789&#39;</span><span class="p">],</span><span class="s1">&#39;statuses[]&#39;</span><span class="p">:[</span><span class="s1">&#39;triggered&#39;</span><span class="p">]}</span>
<span class="p">))</span>
<span class="c1"># Change their state</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">incidents</span><span class="p">:</span>
    <span class="n">i</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;acknowledged&#39;</span>
<span class="c1"># PUT the updated list back up to the API</span>
<span class="n">updated_incidents</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">rput</span><span class="p">(</span><span class="s1">&#39;incidents&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">incidents</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="general-concepts">
<h3>General Concepts<a class="headerlink" href="#general-concepts" title="Permalink to this headline">¶</a></h3>
<p>In all cases, when sending or receiving data through the REST API using
<code class="docutils literal notranslate"><span class="pre">pdpyras</span></code>, note the following:</p>
<div class="section" id="urls">
<h4>URLs<a class="headerlink" href="#urls" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><strong>There is no need to include the API base URL.</strong> Any path relative to the web
root, leading slash or no, is automatically appended to the base URL when
constructing an API request, i.e. one can specify <code class="docutils literal notranslate"><span class="pre">users/PABC123</span></code> instead
of <code class="docutils literal notranslate"><span class="pre">https://api.pagerduty.com/users/PABC123</span></code>.</li>
<li>One can also pass the full URL of an API endpoint and it will still work, i.e.
the <code class="docutils literal notranslate"><span class="pre">self</span></code> property of any object can be used, and there is no need to strip
out the API base URL.</li>
</ul>
</div>
<div class="section" id="request-and-response-bodies">
<h4>Request and Response Bodies<a class="headerlink" href="#request-and-response-bodies" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Data is represented as dictionary objects, and should have a structure that
mirrors that of the API schema</li>
<li>Everything is automatically JSON-encoded and decoded, using it as follows:<ul>
<li>To send a JSON request body, pass a <code class="docutils literal notranslate"><span class="pre">dict</span></code> object (or <code class="docutils literal notranslate"><span class="pre">list</span></code>, where
applicable) in the <code class="docutils literal notranslate"><span class="pre">json</span></code> keyword argument.</li>
<li>To get the response body as a <code class="docutils literal notranslate"><span class="pre">dict</span></code> (or <code class="docutils literal notranslate"><span class="pre">list</span></code>, if applicable), call
the <a class="reference external" href="http://docs.python-requests.org/en/master/api/#requests.Response.json">json</a>
method of the response object.</li>
<li>If using the <code class="docutils literal notranslate"><span class="pre">r{VERB}</span></code> methods, i.e.  <code class="docutils literal notranslate"><span class="pre">rget</span></code>, the return value will be
the <code class="docutils literal notranslate"><span class="pre">dict</span></code>/<code class="docutils literal notranslate"><span class="pre">list</span></code> and there is no need to call <code class="docutils literal notranslate"><span class="pre">response.json()</span></code></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="using-special-features-of-requests">
<h4>Using Special Features of Requests<a class="headerlink" href="#using-special-features-of-requests" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Keyword arguments to the verb functions get passed through to the similarly-
named functions in <a class="reference external" href="http://docs.python-requests.org/en/master/api/#request-sessions">requests.Session</a>, so for additional options, please
refer to the documentation provided by the Requests project.</li>
</ul>
</div>
</div>
<div class="section" id="data-access-abstraction">
<h3>Data Access Abstraction<a class="headerlink" href="#data-access-abstraction" title="Permalink to this headline">¶</a></h3>
<p>Using <a class="reference internal" href="#pdpyras.APISession.iter_all" title="pdpyras.APISession.iter_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.iter_all</span></code></a> and <a class="reference internal" href="#pdpyras.APISession.find" title="pdpyras.APISession.find"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.find</span></code></a>
as documented, it is easier to directly get to the underlying data representing
a given PagerDuty object. Both of these methods yield/return dicts representing
the PagerDuty objects with their defined schemas (see: <a class="reference external" href="v2.developer.pagerduty.com/v2/page/api-reference#!/API_Reference/get_api_reference">REST API Reference</a>).</p>
<p>In version 2, it is even easier to do this, and in more ways, with four new
methods of <a class="reference internal" href="#pdpyras.APISession" title="pdpyras.APISession"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdpyras.APISession</span></code></a>, named exactly after the original HTTP
verb functions but with <code class="docutils literal notranslate"><span class="pre">r</span></code> prepended to them: <code class="docutils literal notranslate"><span class="pre">rget</span></code>, <code class="docutils literal notranslate"><span class="pre">rpost</span></code>, <code class="docutils literal notranslate"><span class="pre">rput</span></code>
and <code class="docutils literal notranslate"><span class="pre">rdelete</span></code>.</p>
<div class="section" id="reading">
<h4>Reading<a class="headerlink" href="#reading" title="Permalink to this headline">¶</a></h4>
<p>The method <a class="reference internal" href="#pdpyras.APISession.rget" title="pdpyras.APISession.rget"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.rget</span></code></a> gets a resource, returning the object
within the resource name envelope after JSON-decoding the response body. In
other words, if retrieving an individual user (for instance), where one would
have to JSON-decode and then access the <code class="docutils literal notranslate"><span class="pre">user</span></code> key in the resulting
dictionary object, that object itself is directly returned.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">rget</span></code> method can be called with as little as one argument: the URL (or
URL path) to request. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">service</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">rget</span><span class="p">(</span><span class="s1">&#39;/services/PZYX321&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Service PZYX321&#39;s name: &quot;</span><span class="o">+</span><span class="n">service</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>One can also use it on a <a class="reference external" href="https://v2.developer.pagerduty.com/docs/endpoints#resources-index">resource index</a>, although if the goal is to get all
results rather than a specific page, <a class="reference internal" href="#pdpyras.APISession.iter_all" title="pdpyras.APISession.iter_all"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdpyras.APISession.iter_all</span></code></a> is
recommended for this purpose, as it will automatically iterate through all
pages of results, rather than just the first. When using <code class="docutils literal notranslate"><span class="pre">rget</span></code> in this way,
the return value will be a list of dicts instead of a dict.</p>
<p>The method also accepts other keyword arguments, which it will pass along to
<code class="docutils literal notranslate"><span class="pre">reqeusts.Session.get</span></code>, i.e. if requesting an index, <code class="docutils literal notranslate"><span class="pre">params</span></code> can be used
to set a filter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">first_100_daves</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">rget</span><span class="p">(</span>
    <span class="s1">&#39;/users&#39;</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;query&#39;</span><span class="p">:</span><span class="s2">&quot;Dave&quot;</span><span class="p">,</span><span class="s1">&#39;limit&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-and-updating">
<h4>Creating and Updating<a class="headerlink" href="#creating-and-updating" title="Permalink to this headline">¶</a></h4>
<p>Just as <code class="docutils literal notranslate"><span class="pre">rget</span></code> eliminates the need to JSON-decode and then pull the data out
of the envelope in the response schema, <a class="reference internal" href="#pdpyras.APISession.rpost" title="pdpyras.APISession.rpost"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.rpost</span></code></a> and
<a class="reference internal" href="#pdpyras.APISession.rput" title="pdpyras.APISession.rput"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.rput</span></code></a> return the data in the envelope property.
Furthermore, they eliminate the need to enclose the dictionary object
representing the data to be transmitted in an envelope, and just like <code class="docutils literal notranslate"><span class="pre">rget</span></code>,
they accept at an absolute minimum one positional argument (the URL), and all
keyword arguments are passed through to the underlying request method function.</p>
<p>For instance, instead of having to set the keyword argument <code class="docutils literal notranslate"><span class="pre">json</span> <span class="pre">=</span> <span class="pre">{&quot;user&quot;:</span>
<span class="pre">{...}}</span></code> to <code class="docutils literal notranslate"><span class="pre">put</span></code>, one can pass <code class="docutils literal notranslate"><span class="pre">json</span> <span class="pre">=</span> <span class="pre">{...}</span></code> to <code class="docutils literal notranslate"><span class="pre">rput</span></code>, to update a
user. The following function takes a PagerDuty user ID and gives the
user the admin role and prints a message when done:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">promote_to_admin</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">uid</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">rput</span><span class="p">(</span>
        <span class="s1">&#39;/users/&#39;</span><span class="o">+</span><span class="n">uid</span><span class="p">,</span>
        <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;role&#39;</span><span class="p">:</span><span class="s1">&#39;admin&#39;</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> now has admin superpowers&quot;</span><span class="o">%</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="deleting">
<h4>Deleting<a class="headerlink" href="#deleting" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">rdelete</span></code> method has no return value, but otherwise behaves in exactly
the same way as the other request methods with <code class="docutils literal notranslate"><span class="pre">r</span></code> prepended to their name.
Like the other <code class="docutils literal notranslate"><span class="pre">r*</span></code> methods, it will raise <a class="reference internal" href="#pdpyras.PDClientError" title="pdpyras.PDClientError"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdpyras.PDClientError</span></code></a> if
the API responds with a non-success HTTP status.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">rdelete</span><span class="p">(</span><span class="s2">&quot;/services/PI86NOW&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Service deleted.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="managing-a-k-a-multi-updating">
<h4>Managing, a.k.a. Multi-Updating<a class="headerlink" href="#managing-a-k-a-multi-updating" title="Permalink to this headline">¶</a></h4>
<p>Introduced in version 2.1 is support for automatic data envelope functionality
in multi-update actions.</p>
<p>As of this writing, multi-update is limited to the following actions:</p>
<ul class="simple">
<li><a class="reference external" href="https://v2.developer.pagerduty.com/v2/page/api-reference#!/Incidents/put_incidents">PUT /incidents</a></li>
<li><a class="reference external" href="https://v2.developer.pagerduty.com/v2/page/api-reference#!/Incidents/put_incidents_id_alerts">PUT /incidents/{id}/alerts</a></li>
<li>PUT /priorities (not yet published, as of 2018-11-28)</li>
</ul>
<p>To use, simply pass in a list of objects or references (dictionaries having a
structure according to the API schema reference for that object type) to the
<code class="docutils literal notranslate"><span class="pre">json</span></code> keyword argument of <a class="reference internal" href="#pdpyras.APISession.rput" title="pdpyras.APISession.rput"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.rput</span></code></a>, and the final
payload will be an object with one property named after the resource,
containing that list.</p>
<p>For instance, to resolve two incidents with IDs <code class="docutils literal notranslate"><span class="pre">PABC123</span></code> and <code class="docutils literal notranslate"><span class="pre">PDEF456</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">rput</span><span class="p">(</span>
    <span class="s2">&quot;incidents&quot;</span><span class="p">,</span>
    <span class="n">json</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="s1">&#39;PABC123&#39;</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;incident_reference&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">:</span><span class="s1">&#39;resolved&#39;</span><span class="p">},</span>
          <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="s1">&#39;PDEF456&#39;</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;incident_reference&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">:</span><span class="s1">&#39;resolved&#39;</span><span class="p">}]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>In this way, a single API request can more efficiently perform multiple update
actions.</p>
<p>It is important to note, however, that certain actions such as updating
incidents require the <code class="docutils literal notranslate"><span class="pre">From</span></code> header, which should be the login email address
of a valid PagerDuty user.</p>
</div>
</div>
<div class="section" id="error-handling">
<h3>Error Handling<a class="headerlink" href="#error-handling" title="Permalink to this headline">¶</a></h3>
<p>What happens when, for any of the <code class="docutils literal notranslate"><span class="pre">r*</span></code> methods, the API responds with a
non-success HTTP status? Obviously in this case, they cannot return the
JSON-decoded response, because the response would not be the sought-after data
but a different schema altogether (see: <a class="reference external" href="https://v2.developer.pagerduty.com/docs/errors">Errors</a>), and this would put the onus
on the end user to distinguish between success and error based on the structure
of the returned dictionary object (yuck).</p>
<p>Instead, when this happens, a <a class="reference internal" href="#pdpyras.PDClientError" title="pdpyras.PDClientError"><code class="xref py py-class docutils literal notranslate"><span class="pre">pdpyras.PDClientError</span></code></a> exception is
raised. The advantage of this design lies in how the methods can always be
expected to return the same sort of data, and if they can’t, the program flow
that depends on getting this specific structure of data is appropriately
interrupted. Moreover, because (as of version 2) this exception class will have
the <a class="reference external" href="http://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object as its <code class="docutils literal notranslate"><span class="pre">response</span></code> property (whenever the
exception pertains to a HTTP error), the end user can define specialized error
handling logic in which the REST API response data (i.e. headers, code and body)
are directly available.</p>
<p>For instance, the following code prints “User not found” in the event of a 404,
raises the underlying exception in the event of an incorrect API access token (401
Unauthorized) or non-transient network error, prints out the user’s email if
the user exists, and does nothing otherwise:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">rget</span><span class="p">(</span><span class="s2">&quot;/users/PJKL678&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">])</span>
<span class="k">except</span> <span class="n">PDClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User not found&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">e</span>
</pre></div>
</div>
<p>Just make sure to import <cite>PDClientError</cite> or reference it throught he namespace, i.e.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pdpyras</span> <span class="k">import</span> <span class="n">APISession</span><span class="p">,</span> <span class="n">PDClientError</span>

<span class="k">except</span> <span class="n">PDClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</pre></div>
</div>
<p>Or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pdpyras</span>

<span class="o">...</span>

<span class="k">except</span> <span class="n">pdpyras</span><span class="o">.</span><span class="n">PDClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="http-retry-logic">
<h3>HTTP Retry Logic<a class="headerlink" href="#http-retry-logic" title="Permalink to this headline">¶</a></h3>
<p>By default, after receiving a response, <a class="reference internal" href="#pdpyras.APISession.request" title="pdpyras.APISession.request"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.request</span></code></a> will
return the <a class="reference external" href="http://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object unless its status is <code class="docutils literal notranslate"><span class="pre">429</span></code> (rate
limiting), in which case it will retry until it gets a status other than <code class="docutils literal notranslate"><span class="pre">429</span></code>.</p>
<p>The property <a class="reference internal" href="#pdpyras.APISession.retry" title="pdpyras.APISession.retry"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.retry</span></code></a> allows customization in this
regard, so that the client can be made to retry on other statuses (i.e.
502/400), up to a set number of times. The total number of HTTP error responses
that the client will tolerate before returning the response object is defined
in <a class="reference internal" href="#pdpyras.APISession.max_http_attempts" title="pdpyras.APISession.max_http_attempts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.max_http_attempts</span></code></a>, and this will supersede the
maximum number of retries defined in
<a class="reference internal" href="#pdpyras.APISession.max_http_attempts" title="pdpyras.APISession.max_http_attempts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdpyras.APISession.max_http_attempts</span></code></a>.</p>
<p>For example, the following will take about 30 seconds plus API request time
(carrying out four attempts, with 2, 4, 8 and 16 second pauses between them),
before finally returning with the status 404 <a class="reference external" href="http://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">retry</span><span class="p">[</span><span class="mi">404</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">session</span><span class="o">.</span><span class="n">max_http_attempts</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">session</span><span class="o">.</span><span class="n">sleep_timer</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">session</span><span class="o">.</span><span class="n">sleep_timer_base</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/users/PNOEXST&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h2>
<p>Bug reports and pull requests to fix issues are always welcome.</p>
<p>If adding features, or making changes, it is recommended to update or add tests
and assertions to the class <code class="docutils literal notranslate"><span class="pre">APISessionTest</span></code> in <code class="docutils literal notranslate"><span class="pre">test_pdpyras.py</span></code> to ensure
code coverage. If the change(s) fix a bug, please add assertions that reproduce
the bug along with code changes themselves, and include the GitHub issue number
in the commit
message.</p>
<p><em>Code author: Demitri Morgan &lt;<a class="reference external" href="mailto:demitri&#37;&#52;&#48;pagerduty&#46;com">demitri<span>&#64;</span>pagerduty<span>&#46;</span>com</a>&gt;</em></p>
</div>
<div class="section" id="developer-interface">
<h2>Developer Interface<a class="headerlink" href="#developer-interface" title="Permalink to this headline">¶</a></h2>
<div class="section" id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pdpyras.APISession">
<em class="property">class </em><code class="descclassname">pdpyras.</code><code class="descname">APISession</code><span class="sig-paren">(</span><em>token</em>, <em>name=None</em>, <em>default_from=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession" title="Permalink to this definition">¶</a></dt>
<dd><p>Reusable PagerDuty REST API session objects for making API requests.</p>
<p>These are essentially the same as <a class="reference external" href="http://docs.python-requests.org/en/master/api/#request-sessions">requests.Session</a> objects, but with a
few modifications:</p>
<ul class="simple">
<li>The client will reattempt the request with configurable, auto-increasing
cooldown/retry intervals if encountering a network error or rate limit</li>
<li>When making requests, headers specified ad-hoc in calls to HTTP verb
functions will not replace, but will be merged with, default headers.</li>
<li>The request URL, if it doesn’t already start with the REST API base URL,
will be prepended with the default REST API base URL.</li>
<li>It will only perform GET, POST, PUT and DELETE requests, and will raise
<a class="reference internal" href="#pdpyras.PDClientError" title="pdpyras.PDClientError"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDClientError</span></code></a> for any other HTTP methods.</li>
<li>Some convenience functions, i.e. <a class="reference internal" href="#pdpyras.APISession.rget" title="pdpyras.APISession.rget"><code class="xref py py-attr docutils literal notranslate"><span class="pre">rget</span></code></a>, <a class="reference internal" href="#pdpyras.APISession.find" title="pdpyras.APISession.find"><code class="xref py py-attr docutils literal notranslate"><span class="pre">find</span></code></a> and
<a class="reference internal" href="#pdpyras.APISession.iter_all" title="pdpyras.APISession.iter_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iter_all</span></code></a></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>token</strong> (<em>str</em>) – REST API access token to use for HTTP requests</li>
<li><strong>name</strong> (<em>str</em><em> or </em><em>None</em>) – Optional name identifier for logging. If unspecified or
<code class="docutils literal notranslate"><span class="pre">None</span></code>, it will be the last four characters of the REST API token.</li>
<li><strong>default_from</strong> (<em>str</em><em> or </em><em>None</em>) – Email address of a valid PagerDuty user to use in
API requests by default as the <code class="docutils literal notranslate"><span class="pre">From</span></code> header (see: <a class="reference external" href="https://v2.developer.pagerduty.com/docs/rest-api#http-request-headers">HTTP Request
Headers</a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Members:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pdpyras.APISession.rdelete">
<code class="descname">rdelete</code><span class="sig-paren">(</span><em>self</em>, <em>path</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.rdelete" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pdpyras.APISession.rget">
<code class="descname">rget</code><span class="sig-paren">(</span><em>self</em>, <em>path</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.rget" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pdpyras.APISession.rpost">
<code class="descname">rpost</code><span class="sig-paren">(</span><em>self</em>, <em>path</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.rpost" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pdpyras.APISession.rput">
<code class="descname">rput</code><span class="sig-paren">(</span><em>self</em>, <em>path</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.rput" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.api_call_counts">
<code class="descname">api_call_counts</code><em class="property"> = None</em><a class="headerlink" href="#pdpyras.APISession.api_call_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>A dict object recording the number of API calls per endpoint</p>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.api_time">
<code class="descname">api_time</code><em class="property"> = None</em><a class="headerlink" href="#pdpyras.APISession.api_time" title="Permalink to this definition">¶</a></dt>
<dd><p>A dict object recording the total time of API calls to each endpoint</p>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.default_from">
<code class="descname">default_from</code><em class="property"> = None</em><a class="headerlink" href="#pdpyras.APISession.default_from" title="Permalink to this definition">¶</a></dt>
<dd><p>The default value to use as the <code class="docutils literal notranslate"><span class="pre">From</span></code> request header</p>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.default_page_size">
<code class="descname">default_page_size</code><em class="property"> = 100</em><a class="headerlink" href="#pdpyras.APISession.default_page_size" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be the default number of results requested in each page when
iterating/querying an index (the <code class="docutils literal notranslate"><span class="pre">limit</span></code> parameter). See: <a class="reference external" href="https://v2.developer.pagerduty.com/docs/pagination">pagination</a>.</p>
</dd></dl>

<dl class="method">
<dt id="pdpyras.APISession.dict_all">
<code class="descname">dict_all</code><span class="sig-paren">(</span><em>path</em>, <em>by='id'</em>, <em>params=None</em>, <em>paginate=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.dict_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of all objects from a given index endpoint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> – The index endpoint URL to use.</li>
<li><strong>by</strong> – The attribute of each object to use for the key values of the
dictionary. This is <code class="docutils literal notranslate"><span class="pre">id</span></code> by default. Please note, there is no
uniqueness validation, so if you use an attribute that is not
distinct for the data set, this function will omit some data in the
results.</li>
<li><strong>params</strong> – Additional URL parameters to include.</li>
<li><strong>paginate</strong> – If True, use <a class="reference external" href="https://v2.developer.pagerduty.com/docs/pagination">pagination</a> to get through all available results. If
False, ignore / don’t page through more than the first 100 results.
Useful for special index endpoints that don’t fully support
pagination yet, i.e. “nested” endpoints like
<code class="docutils literal notranslate"><span class="pre">/users/{id}/contact_methods</span></code> and <code class="docutils literal notranslate"><span class="pre">/services/{id}/integrations</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pdpyras.APISession.find">
<code class="descname">find</code><span class="sig-paren">(</span><em>resource</em>, <em>query</em>, <em>attribute='name'</em>, <em>params=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.find" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds an object of a given resource exactly matching a query.</p>
<p>Will query a given <a class="reference external" href="https://v2.developer.pagerduty.com/docs/endpoints#resources-index">resource index</a> endpoint using the <code class="docutils literal notranslate"><span class="pre">query</span></code>
parameter supported by most indexes.</p>
<p>Returns a dict if a result is found. The structure will be that of an
entry in the index endpoint schema’s array of results. Otherwise, it
will return <cite>None</cite> if no result is found or an error is encountered.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>resource</strong> (<em>str</em>) – The name of the resource endpoint to query, i.e.
<code class="docutils literal notranslate"><span class="pre">escalation_policies</span></code></li>
<li><strong>query</strong> (<em>str</em>) – The string to query for in the the index.</li>
<li><strong>attribute</strong> (<em>str</em>) – The property of each result to compare against the query value when
searching for an exact match. By default it is <code class="docutils literal notranslate"><span class="pre">name</span></code>, but when
searching for user by email (for example) it can be set to <code class="docutils literal notranslate"><span class="pre">email</span></code></li>
<li><strong>params</strong> (<em>dict</em><em> or </em><em>None</em>) – Optional additional parameters to use when querying.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pdpyras.APISession.iter_all">
<code class="descname">iter_all</code><span class="sig-paren">(</span><em>path</em>, <em>params=None</em>, <em>paginate=True</em>, <em>item_hook=None</em>, <em>total=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.iter_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator for the contents of an index endpoint or query.</p>
<p>Automatically paginates and yields the results in each page, until all
matching results have been yielded or a HTTP error response is received.</p>
<p>Each yielded value is a dict object representing a result returned from
the index. For example, if requesting the <code class="docutils literal notranslate"><span class="pre">/users</span></code> endpoint, each
yielded value will be an entry of the <code class="docutils literal notranslate"><span class="pre">users</span></code> array property in the
response; see: <a class="reference external" href="https://v2.developer.pagerduty.com/v2/page/api-reference#!/Users/get_users">List Users</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<em>str</em>) – The index endpoint URL to use.</li>
<li><strong>params</strong> (<em>dict</em><em> or </em><em>None</em>) – Additional URL parameters to include.</li>
<li><strong>paginate</strong> (<em>bool</em>) – If True, use <a class="reference external" href="https://v2.developer.pagerduty.com/docs/pagination">pagination</a> to get through all available results. If
False, ignore / don’t page through more than the first 100 results.
Useful for special index endpoints that don’t fully support
pagination yet, i.e. “nested” endpoints like
<code class="docutils literal notranslate"><span class="pre">/users/{id}/contact_methods</span></code> and <code class="docutils literal notranslate"><span class="pre">/services/{id}/integrations</span></code></li>
<li><strong>item_hook</strong> – Callable object that will be invoked for each iteration, i.e. for
printing progress. It will be called with three parameters: a dict
representing a given result in the iteration, the number of the
item, and the total number of items in the series.</li>
<li><strong>total</strong> (<em>bool</em>) – If True, the <code class="docutils literal notranslate"><span class="pre">total</span></code> parameter will be included in API calls, and
the value for the third parameter to the item hook will be the total
count of records that match the query. Leaving this as False confers
a small performance advantage, as the API in this case does not have
to compute the total count of results in the query.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first">Results from the index endpoint.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pdpyras.APISession.list_all">
<code class="descname">list_all</code><span class="sig-paren">(</span><em>path</em>, <em>params=None</em>, <em>paginate=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.list_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all objects from a given index endpoint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> – The index endpoint URL to use.</li>
<li><strong>params</strong> – Additional URL parameters to include.</li>
<li><strong>paginate</strong> – If True, use <a class="reference external" href="https://v2.developer.pagerduty.com/docs/pagination">pagination</a> to get through all available results. If
False, ignore / don’t page through more than the first 100 results.
Useful for special index endpoints that don’t fully support
pagination yet, i.e. “nested” endpoints like
<code class="docutils literal notranslate"><span class="pre">/users/{id}/contact_methods</span></code> and <code class="docutils literal notranslate"><span class="pre">/services/{id}/integrations</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.log">
<code class="descname">log</code><em class="property"> = None</em><a class="headerlink" href="#pdpyras.APISession.log" title="Permalink to this definition">¶</a></dt>
<dd><p>A <code class="docutils literal notranslate"><span class="pre">logging.Logger</span></code> object for printing messages.</p>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.max_http_attempts">
<code class="descname">max_http_attempts</code><em class="property"> = 10</em><a class="headerlink" href="#pdpyras.APISession.max_http_attempts" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of times that the client will retry after error statuses, for any
that are defined greater than zero in <a class="reference internal" href="#pdpyras.APISession.retry" title="pdpyras.APISession.retry"><code class="xref py py-attr docutils literal notranslate"><span class="pre">retry</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.max_network_attempts">
<code class="descname">max_network_attempts</code><em class="property"> = 3</em><a class="headerlink" href="#pdpyras.APISession.max_network_attempts" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of times that connecting to the API will be attempted before
treating the failure as non-transient; a <a class="reference internal" href="#pdpyras.PDClientError" title="pdpyras.PDClientError"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDClientError</span></code></a> exception
will be raised if this happens.</p>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.parent">
<code class="descname">parent</code><em class="property"> = None</em><a class="headerlink" href="#pdpyras.APISession.parent" title="Permalink to this definition">¶</a></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">super</span></code> object (<a class="reference external" href="http://docs.python-requests.org/en/master/api/#request-sessions">requests.Session</a>)</p>
</dd></dl>

<dl class="method">
<dt id="pdpyras.APISession.profile">
<code class="descname">profile</code><span class="sig-paren">(</span><em>response</em>, <em>suffix=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Records performance information about the API call.</p>
<p>This method is called automatically by <a class="reference internal" href="#pdpyras.APISession.request" title="pdpyras.APISession.request"><code class="xref py py-func docutils literal notranslate"><span class="pre">request()</span></code></a> for all requests,
and can be extended in child classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>method</strong> (<em>str</em>) – Method of the request</li>
<li><strong>response</strong> (<a class="reference external" href="http://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a>) – Response object</li>
<li><strong>suffix</strong> (<em>str</em><em> or </em><em>None</em>) – Optional suffix to append to the key</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pdpyras.APISession.profiler_key">
<code class="descname">profiler_key</code><span class="sig-paren">(</span><em>method</em>, <em>path</em>, <em>suffix=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.profiler_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a fixed-format key to classify a request, i.e. for profiling.</p>
<p>Returns a string that will have all instances of IDs replaced with
<code class="docutils literal notranslate"><span class="pre">{id}</span></code>, and will begin with the method in lower case followed by a
colon, i.e. <code class="docutils literal notranslate"><span class="pre">get:escalation_policies/{id}</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>method</strong> (<em>str</em>) – The request method</li>
<li><strong>path</strong> (<em>str</em>) – The path/URI to classify</li>
<li><strong>suffix</strong> (<em>str</em>) – Optional suffix to append to the key</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.raise_if_http_error">
<code class="descname">raise_if_http_error</code><em class="property"> = True</em><a class="headerlink" href="#pdpyras.APISession.raise_if_http_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise an exception upon receiving an error response from the server.</p>
<p>If set to true, an exception will be raised in <a class="reference internal" href="#pdpyras.APISession.iter_all" title="pdpyras.APISession.iter_all"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iter_all</span></code></a> if a HTTP
error is encountered. This is the default behavior in versions &gt;= 2.1.0.
If False, the behavior is to halt iteration upon receiving a HTTP error.</p>
</dd></dl>

<dl class="method">
<dt id="pdpyras.APISession.request">
<code class="descname">request</code><span class="sig-paren">(</span><em>method</em>, <em>url</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.APISession.request" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a generic PagerDuty v2 REST API request.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>method</strong> (<em>str</em>) – The request method to use. Case-insensitive. May be one of get, put,
post or delete.</li>
<li><strong>url</strong> (<em>str</em>) – The path/URL to request. If it does not start with the PagerDuty
REST API’s base URL, the base URL will be prepended.</li>
<li><strong>**kwargs</strong> – <p>Additional keyword arguments to pass to <a class="reference external" href="http://docs.python-requests.org/en/master/api/#requests.Session.request">requests.Session.request</a></p>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the HTTP response object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="http://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.retry">
<code class="descname">retry</code><em class="property"> = None</em><a class="headerlink" href="#pdpyras.APISession.retry" title="Permalink to this definition">¶</a></dt>
<dd><p>A dict defining the retry behavior for each HTTP response status code.</p>
<p>Each key in this dictionary represents a HTTP response code. The behavior is
specified by the value at each key as follows:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">-1</span></code> to retry infinitely</li>
<li><code class="docutils literal notranslate"><span class="pre">0</span></code> to return the <a class="reference external" href="http://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object and exit (which is the
default behavior)</li>
<li><code class="docutils literal notranslate"><span class="pre">n</span></code>, where <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>, to retry <code class="docutils literal notranslate"><span class="pre">n</span></code> times (or up
to <a class="reference internal" href="#pdpyras.APISession.max_http_attempts" title="pdpyras.APISession.max_http_attempts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">max_http_attempts</span></code></a> total for all statuses, whichever is
encountered first), and rase a <a class="reference internal" href="#pdpyras.PDClientError" title="pdpyras.PDClientError"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDClientError</span></code></a> after that many
attempts. For each successive attempt, the wait time will increase by a
factor of <a class="reference internal" href="#pdpyras.APISession.sleep_timer_base" title="pdpyras.APISession.sleep_timer_base"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sleep_timer_base</span></code></a>.</li>
</ul>
<p>The default behavior is to retry infinitely on a 429, and return the
response in any other case (assuming a HTTP response was received from the
server).</p>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.sleep_timer">
<code class="descname">sleep_timer</code><em class="property"> = 1.5</em><a class="headerlink" href="#pdpyras.APISession.sleep_timer" title="Permalink to this definition">¶</a></dt>
<dd><p>Default initial cooldown time factor for rate limiting and network errors.</p>
<p>Each time that the request makes a followup request, there will be a delay
in seconds equal to this number times <a class="reference internal" href="#pdpyras.APISession.sleep_timer_base" title="pdpyras.APISession.sleep_timer_base"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sleep_timer_base</span></code></a> to the power
of how many attempts have already been made so far.</p>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.sleep_timer_base">
<code class="descname">sleep_timer_base</code><em class="property"> = 2</em><a class="headerlink" href="#pdpyras.APISession.sleep_timer_base" title="Permalink to this definition">¶</a></dt>
<dd><p>After each retry, the time to sleep before reattempting the API connection
and request will increase by a factor of this amount.</p>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.subdomain">
<code class="descname">subdomain</code><a class="headerlink" href="#pdpyras.APISession.subdomain" title="Permalink to this definition">¶</a></dt>
<dd><p>Subdomain of the PagerDuty account of the API access token.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str or None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.token">
<code class="descname">token</code><a class="headerlink" href="#pdpyras.APISession.token" title="Permalink to this definition">¶</a></dt>
<dd><p>The REST API token to use.</p>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.total_call_count">
<code class="descname">total_call_count</code><a class="headerlink" href="#pdpyras.APISession.total_call_count" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number of API calls made by this instance.</p>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.total_call_time">
<code class="descname">total_call_time</code><a class="headerlink" href="#pdpyras.APISession.total_call_time" title="Permalink to this definition">¶</a></dt>
<dd><p>The total time spent making API calls.</p>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.trunc_token">
<code class="descname">trunc_token</code><a class="headerlink" href="#pdpyras.APISession.trunc_token" title="Permalink to this definition">¶</a></dt>
<dd><p>Truncated token for secure display/identification purposes.</p>
</dd></dl>

<dl class="attribute">
<dt id="pdpyras.APISession.url">
<code class="descname">url</code><em class="property"> = 'https://api.pagerduty.com'</em><a class="headerlink" href="#pdpyras.APISession.url" title="Permalink to this definition">¶</a></dt>
<dd><p>Base URL of the REST API</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pdpyras.PDClientError">
<em class="property">class </em><code class="descclassname">pdpyras.</code><code class="descname">PDClientError</code><span class="sig-paren">(</span><em>message</em>, <em>response=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.PDClientError" title="Permalink to this definition">¶</a></dt>
<dd><p>General API errors base class.</p>
<dl class="attribute">
<dt id="pdpyras.PDClientError.response">
<code class="descname">response</code><em class="property"> = None</em><a class="headerlink" href="#pdpyras.PDClientError.response" title="Permalink to this definition">¶</a></dt>
<dd><p>The HTTP response object, if a response was successfully received.</p>
<p>In the case of network errors, this property will be None.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pdpyras">
<span id="functions"></span><h3>Functions<a class="headerlink" href="#module-pdpyras" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pdpyras.object_type">
<code class="descclassname">pdpyras.</code><code class="descname">object_type</code><span class="sig-paren">(</span><em>r_name</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.object_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Derives an object type (i.e. <code class="docutils literal notranslate"><span class="pre">user</span></code>) from a resource name (i.e. <code class="docutils literal notranslate"><span class="pre">users</span></code>)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>r_name</strong> – Resource name, i.e. would be <code class="docutils literal notranslate"><span class="pre">users</span></code> for the resource index URL
<code class="docutils literal notranslate"><span class="pre">https://api.pagerduty.com/users</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The object type name; usually the <code class="docutils literal notranslate"><span class="pre">type</span></code> property of an instance
of the given resource.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pdpyras.raise_on_error">
<code class="descclassname">pdpyras.</code><code class="descname">raise_on_error</code><span class="sig-paren">(</span><em>r</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.raise_on_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise an exception if a HTTP error response has error status.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>r</strong> (<a class="reference external" href="http://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a>) – Response object corresponding to the response received.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The response object, if its status was success</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="http://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pdpyras.resource_envelope">
<code class="descclassname">pdpyras.</code><code class="descname">resource_envelope</code><span class="sig-paren">(</span><em>method</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.resource_envelope" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience and consistency decorator for HTTP verb functions.</p>
<p>This makes the request methods <code class="docutils literal notranslate"><span class="pre">GET</span></code>, <code class="docutils literal notranslate"><span class="pre">POST</span></code> and <code class="docutils literal notranslate"><span class="pre">PUT</span></code> always return a
dictionary object representing the resource at the envelope property (i.e.
the <code class="docutils literal notranslate"><span class="pre">{...}</span></code> from <code class="docutils literal notranslate"><span class="pre">{&quot;escalation_policy&quot;:{...}}</span></code> in a get/put request to
an escalation policy)  rather than a <a class="reference external" href="http://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object.</p>
<p>Methods using this decorator will raise a <a class="reference internal" href="#pdpyras.PDClientError" title="pdpyras.PDClientError"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDClientError</span></code></a> with its
<code class="docutils literal notranslate"><span class="pre">response</span></code> property being being the <a class="reference external" href="http://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a> object in the
case of any error, so that the implementer can access it by catching the
exception, and thus design their own custom logic around different types of
error responses.</p>
<p>It allows creation of methods that can provide more succinct ways of making
API calls. In particular, the methods using this decorator don’t require
checking for a success status, JSON-decoding the response body and then
pulling the essential data out of the envelope (i.e. for <code class="docutils literal notranslate"><span class="pre">GET</span>
<span class="pre">/escalation_policies/{id}</span></code> one would have to access the
<code class="docutils literal notranslate"><span class="pre">escalation_policy</span></code> property of the object decoded from the response body,
assuming nothing went wrong in the whole process).</p>
<p>These methods are <a class="reference internal" href="#pdpyras.APISession.rget" title="pdpyras.APISession.rget"><code class="xref py py-attr docutils literal notranslate"><span class="pre">APISession.rget</span></code></a>, <a class="reference internal" href="#pdpyras.APISession.rpost" title="pdpyras.APISession.rpost"><code class="xref py py-attr docutils literal notranslate"><span class="pre">APISession.rpost</span></code></a> and
<a class="reference internal" href="#pdpyras.APISession.rput" title="pdpyras.APISession.rput"><code class="xref py py-attr docutils literal notranslate"><span class="pre">APISession.rput</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>method</strong> – Method being decorated. Must take one positional argument
after <code class="docutils literal notranslate"><span class="pre">self</span></code> that is the URL/path to the resource, and must return an
object of class <a class="reference external" href="http://docs.python-requests.org/en/master/api/#requests.Response">requests.Response</a>, and be named after the HTTP method
but with “r” prepended.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A callable object; the reformed method</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pdpyras.resource_name">
<code class="descclassname">pdpyras.</code><code class="descname">resource_name</code><span class="sig-paren">(</span><em>obj_type</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.resource_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms an object type into a resource name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>obj_type</strong> – The object type, i.e. <code class="docutils literal notranslate"><span class="pre">user</span></code> or <code class="docutils literal notranslate"><span class="pre">user_reference</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The name of the resource, i.e. the last part of the URL for the
resource’s index URL</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pdpyras.tokenize_url_path">
<code class="descclassname">pdpyras.</code><code class="descname">tokenize_url_path</code><span class="sig-paren">(</span><em>url</em>, <em>baseurl='https://api.pagerduty.com'</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpyras.tokenize_url_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Classifies a URL according to some global patterns in the API.</p>
<p>If the URL is to access a specific individual resource by ID, the node type
will be identified as <code class="docutils literal notranslate"><span class="pre">{id}</span></code>, whereas if it is an index, it will be
identified as <code class="docutils literal notranslate"><span class="pre">{index}</span></code>.</p>
<p>For instance, <code class="docutils literal notranslate"><span class="pre">https://api.pagerduty.com/users</span></code> would be classified as
<code class="docutils literal notranslate"><span class="pre">(&quot;users&quot;,</span> <span class="pre">&quot;{index}&quot;)</span></code>, and <code class="docutils literal notranslate"><span class="pre">https://api.pagerduty.com/users/PABC123</span></code>
would be classified as <code class="docutils literal notranslate"><span class="pre">(&quot;users&quot;,</span> <span class="pre">&quot;{id}&quot;)</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>url</strong> (<em>str</em>) – The URL (or path) to be classified; the function should accept either</li>
<li><strong>baseurl</strong> (<em>str</em>) – API base URL</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">PDPYRAS: PagerDuty Python REST API Sessions</a><ul>
<li><a class="reference internal" href="#about">About</a><ul>
<li><a class="reference internal" href="#features">Features</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
<li><a class="reference internal" href="#warranty">Warranty</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#usage-guide">Usage Guide</a><ul>
<li><a class="reference internal" href="#basic-usage">Basic Usage</a></li>
<li><a class="reference internal" href="#general-concepts">General Concepts</a><ul>
<li><a class="reference internal" href="#urls">URLs</a></li>
<li><a class="reference internal" href="#request-and-response-bodies">Request and Response Bodies</a></li>
<li><a class="reference internal" href="#using-special-features-of-requests">Using Special Features of Requests</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-access-abstraction">Data Access Abstraction</a><ul>
<li><a class="reference internal" href="#reading">Reading</a></li>
<li><a class="reference internal" href="#creating-and-updating">Creating and Updating</a></li>
<li><a class="reference internal" href="#deleting">Deleting</a></li>
<li><a class="reference internal" href="#managing-a-k-a-multi-updating">Managing, a.k.a. Multi-Updating</a></li>
</ul>
</li>
<li><a class="reference internal" href="#error-handling">Error Handling</a></li>
<li><a class="reference internal" href="#http-retry-logic">HTTP Retry Logic</a></li>
</ul>
</li>
<li><a class="reference internal" href="#contributing">Contributing</a></li>
<li><a class="reference internal" href="#developer-interface">Developer Interface</a><ul>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#module-pdpyras">Functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, PagerDuty Inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>